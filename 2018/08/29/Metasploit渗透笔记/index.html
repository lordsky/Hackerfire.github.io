<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="google-site-verification" content="wCoNEhJPwtNoql5k0PfiYmMR-rgvliWvNZyGItcI3w0" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Pentest,Metasploit," />





  <link rel="alternate" href="/atom.xml" title="Firehacker" type="application/atom+xml" />






<meta name="description" content="Metasploit—世界上最新流行的渗透测试框架之一，本文参考Offensive-Security-metasploit 及 The Penetration Tester’s Guide对Metasploit框架相关技术及渗透测试流程进行分析总结，然后通过实践体验Metasploit的魅力">
<meta name="keywords" content="Pentest,Metasploit">
<meta property="og:type" content="article">
<meta property="og:title" content="Metasploit渗透笔记">
<meta property="og:url" content="http://yoursite.com/2018/08/29/Metasploit渗透笔记/index.html">
<meta property="og:site_name" content="Firehacker">
<meta property="og:description" content="Metasploit—世界上最新流行的渗透测试框架之一，本文参考Offensive-Security-metasploit 及 The Penetration Tester’s Guide对Metasploit框架相关技术及渗透测试流程进行分析总结，然后通过实践体验Metasploit的魅力">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-09-03T13:28:29.347Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Metasploit渗透笔记">
<meta name="twitter:description" content="Metasploit—世界上最新流行的渗透测试框架之一，本文参考Offensive-Security-metasploit 及 The Penetration Tester’s Guide对Metasploit框架相关技术及渗透测试流程进行分析总结，然后通过实践体验Metasploit的魅力">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/08/29/Metasploit渗透笔记/"/>





  <title>Metasploit渗透笔记 | Firehacker</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>
	
	<a href="https://github.com/Hackerfire" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Firehacker</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-aisec">
          <a href="/AISec/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-eye"></i> <br />
            
            AISec
          </a>
        </li>
      
        
        <li class="menu-item menu-item-community">
          <a href="/community/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-users"></i> <br />
            
            社区
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tools">
          <a href="/tools/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-wrench"></i> <br />
            
            工具
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/links" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-link"></i> <br />
            
            友链
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/29/Metasploit渗透笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Firehacker">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Firehacker">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Metasploit渗透笔记</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-29T11:46:11+08:00">
                2018-08-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/0x02-安全技术/" itemprop="url" rel="index">
                    <span itemprop="name">0x02 安全技术</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/0x02-安全技术/渗透测试/" itemprop="url" rel="index">
                    <span itemprop="name">渗透测试</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/29/Metasploit渗透笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/29/Metasploit渗透笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p><a href="https://www.metasploit.com/" target="_blank" rel="noopener">Metasploit</a>—世界上最新流行的渗透测试框架之一，本文参考<a href="https://www.offensive-security.com/metasploit-unleashed/" target="_blank" rel="noopener">Offensive-Security-metasploit</a> 及 <a href="https://github.com/Urinx/Books/blob/master/metasploit/Metasploit%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8C%87%E5%8D%97.pdf" target="_blank" rel="noopener">The Penetration Tester’s Guide</a>对Metasploit框架相关技术及渗透测试流程进行分析总结，然后通过实践体验Metasploit的魅力</p>
</blockquote>
<a id="more"></a>
<hr>
<h2 id="0x01-Metasploit基础"><a href="#0x01-Metasploit基础" class="headerlink" title="0x01 Metasploit基础"></a>0x01 Metasploit基础</h2><h3 id="1-专业术语"><a href="#1-专业术语" class="headerlink" title="1. 专业术语"></a>1. 专业术语</h3><p><strong>(1) 渗透攻击(Exploit)</strong></p>
<p>由攻击者或渗透测试者利用一个系统，应用或服务中的安全漏洞，所进行的攻击行为</p>
<p><strong>(2) 攻击载荷(Payload)</strong></p>
<p>目标系统被渗透攻击之后期望去执行的代码，在MSF中可以自由选择，传送和植入</p>
<p><strong>(3) Shellcode</strong></p>
<p>在渗透攻击时作为攻击载荷运行的一组机器指令，常用汇编语言编写</p>
<p><strong>(4) 模块(Moudle)</strong></p>
<p>指Metasploit框架中所使用的一段软件代码组件</p>
<p><strong>(5) 监听器(Listener)</strong></p>
<p>Metasploit中用来等待连入网络连接的组件</p>
<h3 id="2-用户接口"><a href="#2-用户接口" class="headerlink" title="2. 用户接口"></a>2. 用户接口</h3><p><strong>(1) MSF终端</strong></p>
<p>一种用户友好的模式提供交互方式，用于访问软件所有的功能特性</p>
<pre><code>msfconsole
</code></pre><p><strong>(2) MSF命令行 </strong></p>
<p><code>msfcli</code>考虑用脚本处理和玉其他命令行工具的互操作性，新版本不再支持，使用<code>msfconsole -x</code>代替</p>
<p><strong>(3) Armitage</strong></p>
<p><code>armitage</code>组件是一个完全交互式的图形化用户接口</p>
<pre><code>armitage
</code></pre><h3 id="3-功能程序"><a href="#3-功能程序" class="headerlink" title="3. 功能程序"></a>3. 功能程序</h3><p><strong>(1) MSF攻击载荷生成器</strong></p>
<p>能够生成<code>shellcode</code>，可执行代码，可以在框架软件之外的渗透代码中进行使用，<code>msfpayload</code>已弃用，由<code>msfvenom</code>工具代替</p>
<p><strong>(2) MSF编码器</strong></p>
<p>通过对原始攻击载荷进行编码，来避免坏字符，以及逃避杀毒软件和IDS的检测，<code>msfencode</code>由<code>msfvenom</code>取代</p>
<p><strong>(3) Nasm Shell</strong></p>
<p><code>nasm_shell.rb</code>功能程序可对给定的汇编命令找出其opcode操作码</p>
<hr>
<h2 id="0x02-情报收集"><a href="#0x02-情报收集" class="headerlink" title="0x02 情报收集"></a>0x02 情报收集</h2><h3 id="1-被动信息收集"><a href="#1-被动信息收集" class="headerlink" title="1. 被动信息收集"></a>1. 被动信息收集</h3><p>在不接触目标系统的情况下挖掘目标信息，<strong>公开情报渠道(OSINT)</strong>是一类对公开和已知信息来检索和筛选就可以获取到的目标情报集合</p>
<p><strong>(1) whois 查询</strong></p>
<pre><code>msf &gt; whois 域名
</code></pre><p><strong>(2) Netcraft</strong></p>
<p><a href="https://searchdns.netcraft.com/" target="_blank" rel="noopener">Netcraft</a>一个网页界面的工具，可以发现承载某个特定网站的服务器IP地址</p>
<pre><code>msf &gt; whois IP
</code></pre><p><strong>(3) NSLookup</strong></p>
<p>可以用于获取关于服务器的附加信息</p>
<pre><code>root@kali:~# nslookup
&gt; 域名
</code></pre><h3 id="2-主动信息收集"><a href="#2-主动信息收集" class="headerlink" title="2. 主动信息收集"></a>2. 主动信息收集</h3><p>与目标系统直接交互，从而对其进行更深入的了解；注意可能被IDS或IPS发现</p>
<p><strong>(1) Nmap 端口扫描</strong></p>
<pre><code>root@kali:~# nmap -sS -Pn IP
</code></pre><p><code>-sS</code>选项用于执行一次隐秘的TCP扫描，以确定某个特定的TCP端口是否开放；</p>
<p><code>-Pn</code>选项告诉nmap不使用ping命令预先判断主机是否存活，默认所有主机处于存活状态，大多数网络不允许ping命令的ICMP通行，避免漏掉许多实际存活的主机</p>
<p><strong>(2) 在Metasploit中使用数据库</strong></p>
<p>Metasploit 支持 MySQL，PostgreSQL 和 SQLite3 数据库</p>
<p>使用init.d脚本启动数据库子系统</p>
<pre><code>root@kali~# /etc/init.d/postgresql start
</code></pre><p>Metasploit 框架连接数据库实例</p>
<pre><code>msf &gt; db_connect postgres:toor@127.0.0.1/msfbook
</code></pre><p>PostgreSQL默认用户名为postgres，口令为toor，使用msfbook作为数据库名</p>
<p>数据库连接状态查看</p>
<pre><code>msf &gt; db_status
</code></pre><p>A. <strong> 将Nmap输出的结果导入Metasploit</strong></p>
<p>使用<code>-oX</code>选项进行扫描，生成名为<code>subnet.xml</code>的文件</p>
<pre><code>nmap -Pn -sS -A -oX submet 192.168.1.0/24
</code></pre><p>使用<code>db_import</code>命令将文件导入到数据库中；完毕后，可使用<code>db_hosts</code>命令合适导入的结果(显示数据库中所有已保存的主机信息)</p>
<pre><code>msf &gt; db_connect postgres:passwd@127.0.0.1/msf3
msf &gt; db_import sbumet.xml
msf &gt; hosts -c address
</code></pre><p>B. <strong>高级 Nmap 技巧: TCP 空闲扫描</strong></p>
<p>TCP 空闲扫描：冒充网络上另一台主机的IP地址，对目标进行隐秘的扫描；可使用Meatsploit框架中的<em>scanner/ip/ipidseq</em>模块，寻找满足TCP空闲扫描要求的空闲主机</p>
<pre><code>msf &gt; use auxiliary/scanner/ip/ipidseq
msf auxiliary(ipidseq) &gt; show options
</code></pre><p>列表显示了执行<em>ipidseq</em>扫描所需的所有参数；<code>RHOST</code>-此参数可使用IP地址段，CIDR地址快，逗号分隔的多个CIDR地址块；<code>THREAD</code>-此参数设定扫描线程数，默认为1，增加参数值可提高扫描速度，降低参数值可减少网络上的数据流量</p>
<p>设定好参数并执行扫描模块</p>
<pre><code>msf auxiliary(ipidseq) &gt; set RHOSTS 192.168.1.0/24
RHOSTS =&gt; 192.168.1.0/24
msf auxiliary(ipidseq) &gt; set THREADS 50
THREADS =&gt; 50
msf auxiliary(ipidseq) &gt; run
</code></pre><p>尝试在nmap中使用-sI选项指定特定IP作为空闲主机(<code>Incremental</code>)对目标主机进行扫描</p>
<pre><code>msf auxiliary(ipidseq) &gt; nmap -PN -sI 空闲IP 目标IP
</code></pre><p>C. <strong> 在 MSF 终端中运行 Nmap</strong></p>
<p>连接到数据库</p>
<pre><code>msf &gt; db_connect postgres:passwd@127.0.0.1/msf3
</code></pre><p>输入<code>db_nmap</code>命令，在MSF终端中运行nmap，并自动将nmap结果存储在数据库中</p>
<pre><code>msf &gt; db_nmap -sS -A 192.168.1.0/24
</code></pre><p>执行 <code>db_services</code> 命令查看数据库中的关于系统上运行服务的扫描结果</p>
<pre><code>msf &gt; services
</code></pre><p><strong>(3) 使用Metasploit进行端口扫描</strong></p>
<p>查看Metasploit框架中提供的端口扫描工具</p>
<pre><code>msf &gt; search portscan
</code></pre><p>使用Metasploit的SYN端口扫描器对单个主机进行一次简单扫描</p>
<pre><code>msf &gt; use scanner/portscan/syn
msf auxiliary(syn) &gt; set RHOSTS IP
RHOSTS =&gt; IP
msf auxiliary(syn) &gt; set THREADS 50
THREADS =&gt; 50
</code></pre><h3 id="3-针对性扫描"><a href="#3-针对性扫描" class="headerlink" title="3. 针对性扫描"></a>3. 针对性扫描</h3><p><strong>(1) 服务器消息块协议扫描</strong></p>
<p>利用<code>smb_version</code>模块遍历一个网络，获取Windows系统的版本号</p>
<pre><code>msf &gt; use scanner/smb/smb_version
msf auxiliary(scanner/smb/smb_version) &gt; show options

Module options (auxiliary/scanner/smb/smb_version):

   Name       Current Setting  Required  Description
   -----------------------------------------------------------------------------------
   RHOSTS                      yes       The target address range or CIDR identifier
   SMBDomain  .                no        The Windows domain to use for authentication
   SMBPass                     no        The password for the specified username
   SMBUser                     no        The username to authenticate as
   THREADS    1                yes       The number of concurrent threads

msf auxiliary(scanner/smb/smb_version) &gt; set RHOSTS IP
RHOSTS =&gt; IP
msf auxiliary(scanner/smb/smb_version) &gt; run
</code></pre><p>可使用 <code>hosts</code> 命令查看数据库中保存的结果</p>
<pre><code>msf auxiliary(scanner/smb/smb_version) &gt; hosts
</code></pre><p><strong>(2) 搜寻配置不当的Microsoft SQL Server</strong></p>
<p>配置不当的MS SQL通常为进入目标系统的第一个后门，容易被忽略；使用<code>mssql_ping</code>对UDP端口1434进行查询，获取随机的TCP端口(1433)</p>
<pre><code>msf &gt; use scanner/mssql/mssql_ping
msf auxiliary(scanner/mssql/mssql_ping) &gt; show options

Module options (auxiliary/scanner/mssql/mssql_ping):

   Name                 Current Setting  Required  Description
   ----                 ---------------  --------  -----------
   PASSWORD                              no        The password for the specified username
   RHOSTS                                yes       The target address range or CIDR identifier
   TDSENCRYPTION        false            yes       Use TLS/SSL for TDS data &quot;Force Encryption&quot;
   THREADS              1                yes       The number of concurrent threads
   USERNAME             sa               no        The username to authenticate as
   USE_WINDOWS_AUTHENT  false            yes       Use windows authentification (requires DOMAIN option set)

msf auxiliary(scanner/mssql/mssql_ping) &gt; set RHOSTS 192.168.1.0/24
RHOSTS =&gt; 192.168.1.0/24
msf auxiliary(scanner/mssql/mssql_ping) &gt; set THREADS 255
THREADS =&gt; 255
msf auxiliary(scanner/mssql/mssql_ping) &gt; run
</code></pre><p><strong>(3) SSH 服务器扫描</strong></p>
<p>许多SSH实现版本中均被发现了安全漏洞，使用Metasploit框架的 <code>ssh_version</code> 模块来识别目标服务器上运行的SSH版本</p>
<pre><code>msf &gt; use scanner/ssh/ssh_version
msf auxiliary(scanner/ssh/ssh_version) &gt; set THREADS 50
THREADS =&gt; 50
msf auxiliary(scanner/ssh/ssh_version) &gt; run 
</code></pre><p><strong>(4) FTP 扫描</strong></p>
<p>FTP服务器是进入一个目标网络最便捷的途径，使用Metasploit框架中<code>ftp_version</code>模块可以对 windows 虚拟机FTP服务器进行扫描</p>
<pre><code>msf &gt; use scanner/ftp/ftp_version
msf auxiliary(scanner/ftp/ftp_version) &gt; show options

Module options (auxiliary/scanner/ftp/ftp_version):

   Name     Current Setting      Required  Description
   ----     ---------------      --------  -----------
   FTPPASS  mozilla@example.com  no        The password for the specified username
   FTPUSER  anonymous            no        The username to authenticate as
   RHOSTS                        yes       The target address range or CIDR identifier
   RPORT    21                   yes       The target port (TCP)
   THREADS  1                    yes       The number of concurrent threads

msf auxiliary(scanner/ftp/ftp_version) &gt; set RHOSTS ip
RHOSTS =&gt; ip
msf auxiliary(scanner/ftp/ftp_version) &gt; set THREADS 50
THREADS =&gt; 50
msf auxiliary(scanner/ftp/ftp_version) &gt; run
</code></pre><p>若成功识别出FTP服务器，可用scanner/ftp/anonymous模块检查FTP服务器是否允许匿名登录</p>
<pre><code>msf &gt; use auxiliary/scanner/ftp/anonymous
msf auxiliary(scanner/ftp/anonymous) &gt; set RHOSTS 192.168.1.0/24
RHOSTS =&gt; 192.168.1.0/24
msf auxiliary(scanner/ftp/anonymous) &gt; set THREADS 50
THREADS =&gt; 50
msf auxiliary(scanner/ftp/anonymous) &gt; run
</code></pre><p><strong>(5) SNMP 扫描</strong></p>
<p>SNMP通常用于网络设备中，用来报告带宽利用率，冲突率等，也可包含在OS中，用来提供类似CPU利用率，空闲内存以及系统状态信息等</p>
<p>Metasploit 框架中包含内置辅助模块<code>scanner/snmp/snmp_enum</code>，为SNMP扫描专门设计；利用<code>scanner/snmp/snmp_login</code>模块可尝试对一个IP或一组IP使用字典猜解SNMP团体字符串</p>
<pre><code>msf &gt; use scanner/snmp/snmp_login
msf auxiliary(scanner/snmp/snmp_login) &gt; set RHOSTS 192.168.1.0/24
RHOSTS =&gt; 192.168.139.0/24
msf auxiliary(scanner/snmp/snmp_login) &gt; set THREADS 50
THREADS =&gt; 50
msf auxiliary(scanner/snmp/snmp_login) &gt; run
</code></pre><hr>
<h2 id="0x03-漏洞扫描"><a href="#0x03-漏洞扫描" class="headerlink" title="0x03 漏洞扫描"></a>0x03 漏洞扫描</h2><h3 id="1-基本漏洞扫描"><a href="#1-基本漏洞扫描" class="headerlink" title="1. 基本漏洞扫描"></a>1. 基本漏洞扫描</h3><p><strong>旗标攫取：</strong>连接到一个远程网络服务，并读取该服务独特的标识</p>
<p>使用<code>netcat</code>获取目标IP的旗标</p>
<pre><code>root@kali:~# nc IP port
</code></pre><h3 id="2-使用-NeXpose-进行扫描"><a href="#2-使用-NeXpose-进行扫描" class="headerlink" title="2. 使用 NeXpose 进行扫描"></a>2. 使用 NeXpose 进行扫描</h3><p>通过对网络进行扫描，查找出网络上正在运行的设备，最终识别出操作系统和应用程序上的安全漏洞</p>
<h3 id="3-使用-Nessus-进行扫描"><a href="#3-使用-Nessus-进行扫描" class="headerlink" title="3. 使用 Nessus 进行扫描"></a>3. 使用 Nessus 进行扫描</h3><p>Nessus 漏洞扫描器是世界上使用最广泛的漏洞扫描器之一</p>
<h3 id="4-专用漏洞扫描器"><a href="#4-专用漏洞扫描器" class="headerlink" title="4. 专用漏洞扫描器"></a>4. 专用漏洞扫描器</h3><p><strong>(1) 验证 SMB 登录</strong></p>
<p><strong>(2) 扫描开放的 VNC 空口令</strong></p>
<p><strong>(3) 扫描开放的 X11 服务器</strong></p>
<h3 id="5-自动化攻击"><a href="#5-自动化攻击" class="headerlink" title="5. 自动化攻击"></a>5. 自动化攻击</h3><hr>
<h2 id="0x04-渗透攻击"><a href="#0x04-渗透攻击" class="headerlink" title="0x04 渗透攻击"></a>0x04 渗透攻击</h2><h3 id="1-渗透攻击基础"><a href="#1-渗透攻击基础" class="headerlink" title="1. 渗透攻击基础"></a>1. 渗透攻击基础</h3><p><strong>(1) msf &gt; show exploits</strong></p>
<p>显示 Metasploit 框架中所有可用的<strong>渗透攻击模块</strong>，在 MSF终端中，针对渗透测试中发现的安全漏洞来实施相应的渗透攻击</p>
<p><strong>(2) msf &gt; show auxiliary</strong></p>
<p>显示所有的<strong>辅助模块</strong>及其用途，可以是扫描器，拒绝服务攻击工具，Fuzz测试器，以及其他类型工具</p>
<p><strong>(3) msf &gt; show options</strong></p>
<p>列出模块所需的各种参数，未选择模块时，显示所有的全局参数</p>
<p><strong>back 命令：</strong>返回 Metasploit 的上一个状态 </p>
<p><strong>search 命令：</strong>查找某个特定的渗透攻击，辅助或者攻击在和模块</p>
<p><strong>use 命令：</strong>加载模块，此时终端中输入的命令在此攻击模块环境中运行</p>
<p><strong>show options：</strong>在已选择模块的命令下，显示模块所需的参数</p>
<p><strong>(4) msf &gt; show payloads</strong></p>
<p>将与当前模块兼容的攻击载荷显示出来</p>
<p><strong>serach 模块 —&gt; use 模块 —&gt; show payloads —&gt; set payload 攻击载荷 —&gt; show options —&gt; payload 利用</strong></p>
<p><strong>(5) msf &gt; show targets</strong></p>
<p>渗透攻击模块可列出受到漏洞影响目标系统的类型</p>
<p><strong>use exploit —&gt; show targets</strong></p>
<p><strong>(6) info</strong></p>
<p><strong>exploit &gt; info / info exploit：</strong>显示模块的详细信息，参数说明以及所有可用的目标操作系统</p>
<p><strong>(7) set 和 unset</strong></p>
<p>参数状态：设置(<strong>set</strong>)或未设置(<strong>unset</strong>)，有些参数被标记为必填项(required)，使用时需经过手工设置并处于启用状态</p>
<p><strong>set</strong> 命令：对某个参数进行设置(同时启用该参数)；<strong>unset</strong> 命令：禁用相关参数</p>
<p><strong>(8) setg 和 unsetg</strong></p>
<p>对全局参数进行设置或清楚，对常用且很少改变的参数设置方便</p>
<p><strong>(9) save</strong></p>
<p>使用setg命令对全局参数进行设置胡，可使用save命令将当前设置值保存下来，下次启用依然使用</p>
<p>设置值保存在<code>/root/.msf4/config</code>，将此文件删除或移动，可恢复原始设置</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Pentest/" rel="tag"><i class="fa fa-tag"></i> Pentest</a>
          
            <a href="/tags/Metasploit/" rel="tag"><i class="fa fa-tag"></i> Metasploit</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/08/24/安全与计算机工具导航/" rel="next" title="安全与计算机工具导航">
                <i class="fa fa-chevron-left"></i> 安全与计算机工具导航
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/09/02/Nmap技术详解/" rel="prev" title="Nmap基础详解">
                Nmap基础详解 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Firehacker</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Hackerfire" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:firehafcker@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://firehacker.top/SecBook" target="_blank" title="Gitbook">
                      
                        <i class="fa fa-fw fa-book"></i>Gitbook</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-Metasploit基础"><span class="nav-number">1.</span> <span class="nav-text">0x01 Metasploit基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-专业术语"><span class="nav-number">1.1.</span> <span class="nav-text">1. 专业术语</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-用户接口"><span class="nav-number">1.2.</span> <span class="nav-text">2. 用户接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-功能程序"><span class="nav-number">1.3.</span> <span class="nav-text">3. 功能程序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-情报收集"><span class="nav-number">2.</span> <span class="nav-text">0x02 情报收集</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-被动信息收集"><span class="nav-number">2.1.</span> <span class="nav-text">1. 被动信息收集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-主动信息收集"><span class="nav-number">2.2.</span> <span class="nav-text">2. 主动信息收集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-针对性扫描"><span class="nav-number">2.3.</span> <span class="nav-text">3. 针对性扫描</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-漏洞扫描"><span class="nav-number">3.</span> <span class="nav-text">0x03 漏洞扫描</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-基本漏洞扫描"><span class="nav-number">3.1.</span> <span class="nav-text">1. 基本漏洞扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-使用-NeXpose-进行扫描"><span class="nav-number">3.2.</span> <span class="nav-text">2. 使用 NeXpose 进行扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-使用-Nessus-进行扫描"><span class="nav-number">3.3.</span> <span class="nav-text">3. 使用 Nessus 进行扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-专用漏洞扫描器"><span class="nav-number">3.4.</span> <span class="nav-text">4. 专用漏洞扫描器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-自动化攻击"><span class="nav-number">3.5.</span> <span class="nav-text">5. 自动化攻击</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-渗透攻击"><span class="nav-number">4.</span> <span class="nav-text">0x04 渗透攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-渗透攻击基础"><span class="nav-number">4.1.</span> <span class="nav-text">1. 渗透攻击基础</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Firehacker</span>

  
</div>


<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

  <!-- <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>
-->





        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'cQ1pKGTukU9T7wK7hVqrFIy0-gzGzoHsz',
        appKey: '6l4mVkOTGKucdJoVS2dNCr0R',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

</body>
</html>
