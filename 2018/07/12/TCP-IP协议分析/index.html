<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Network,TCP/IP," />










<meta name="description" content="学习网路协议断断续续也有一段时间，其中涉及的内容抽象而繁杂，但却重要而开拓思维，所以有必要对核心的网络协议进行梳理，理清其中的原理与关联，最近恰好在研究Wireshark，顺便对TCP/IP协议进行一二梳理">
<meta name="keywords" content="Network,TCP&#x2F;IP">
<meta property="og:type" content="article">
<meta property="og:title" content="TCP&#x2F;IP协议分析">
<meta property="og:url" content="http://yoursite.com/2018/07/12/TCP-IP协议分析/index.html">
<meta property="og:site_name" content="Firehacker">
<meta property="og:description" content="学习网路协议断断续续也有一段时间，其中涉及的内容抽象而繁杂，但却重要而开拓思维，所以有必要对核心的网络协议进行梳理，理清其中的原理与关联，最近恰好在研究Wireshark，顺便对TCP/IP协议进行一二梳理">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ARP%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ARP%E6%95%B0%E6%8D%AE%E5%8C%85.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E6%8E%A9%E7%A0%81.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/IP%E6%8A%A5%E6%96%87.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ICMP.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ICMP%E7%B1%BB%E5%9E%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/TCP%E5%A4%B4%E9%83%A8.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/TCP%E7%AB%AF%E5%8F%A3.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/TCP%E5%9B%9B%E6%AC%A1%E6%8F%A1%E6%89%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/UDP.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/DHCP%E6%8A%A5%E6%96%87.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E5%8F%91%E7%8E%B0.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E6%8F%90%E4%BE%9B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E8%AF%B7%E6%B1%82.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E7%A1%AE%E8%AE%A4.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/DNS.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/DNS%E7%B1%BB%E5%9E%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/DNS%E9%80%92%E5%BD%92.png">
<meta property="og:updated_time" content="2018-07-12T10:04:19.243Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TCP&#x2F;IP协议分析">
<meta name="twitter:description" content="学习网路协议断断续续也有一段时间，其中涉及的内容抽象而繁杂，但却重要而开拓思维，所以有必要对核心的网络协议进行梳理，理清其中的原理与关联，最近恰好在研究Wireshark，顺便对TCP/IP协议进行一二梳理">
<meta name="twitter:image" content="http://paivdtahr.bkt.clouddn.com/ARP%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/07/12/TCP-IP协议分析/"/>





  <title>TCP/IP协议分析 | Firehacker</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Firehacker</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/links" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-link"></i> <br />
            
            links
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/12/TCP-IP协议分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Firehacker">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Firehacker">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">TCP/IP协议分析</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-12T17:34:18+08:00">
                2018-07-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/计算机技术/" itemprop="url" rel="index">
                    <span itemprop="name">计算机技术</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/计算机技术/网络协议/" itemprop="url" rel="index">
                    <span itemprop="name">网络协议</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>学习网路协议断断续续也有一段时间，其中涉及的内容抽象而繁杂，但却重要而开拓思维，所以有必要对核心的网络协议进行梳理，理清其中的原理与关联，最近恰好在研究Wireshark，顺便对TCP/IP协议进行一二梳理</p>
</blockquote>
<a id="more"></a>
<hr>
<h2 id="0x01-ARP协议分析"><a href="#0x01-ARP协议分析" class="headerlink" title="0x01 ARP协议分析"></a>0x01 ARP协议分析</h2><h3 id="ARP协议概述"><a href="#ARP协议概述" class="headerlink" title="ARP协议概述"></a>ARP协议概述</h3><p><strong>逻辑地址：</strong>使不同网络以及没有直接相连的设备之间能够进行通信</p>
<p><strong>物理地址：</strong>用来在单一网段中交换机直接连接的设备之间能够进行通信</p>
<p><strong>MAC地址通信原理：</strong> 网络中用于连接各个设备的交换机使用了内容寻址寄存器（CAM），这个表列出了它在每一个端口的所有连接设备的MAC地址，当交换机收到一个指向特定MAC地址的流量，它就会使用这个表，来确定应该使用哪一个端口发送流量。如果目标的MAC地址是未知的，这个传输设备会首先在它的缓存中查找这个地址，如果没有找到，那么这个地址就需要在网络上额外的通信来进行解析</p>
<h3 id="APR解析过程"><a href="#APR解析过程" class="headerlink" title="APR解析过程"></a>APR解析过程</h3><p>解析过程使用两种数据包：一个ARP请求，一个ARP响应</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ARP%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B.png" alt="ARP"></p>
<p><strong>ARP请求：</strong>传输计算机发出ARP请求，发送源IP地址，源MAC地址，目的IP地址，将此数据包广播给网段中的所有设备，请求拥有目的IP对应的MAC地址</p>
<p><strong>ARP响应：</strong>非此目的IP地址的设备将简单丢弃这个数据包，而拥有这个IP地址的设备将发送一个ARP响应，将MAC地址发送至传输计算机</p>
<p>解析完成后，传输设备对这个设备MAC与IP对应关系的缓存惊醒更新，并开始传输数据</p>
<h3 id="ARP数据包结构"><a href="#ARP数据包结构" class="headerlink" title="ARP数据包结构"></a>ARP数据包结构</h3><p><img src="http://paivdtahr.bkt.clouddn.com/ARP%E6%95%B0%E6%8D%AE%E5%8C%85.png" alt="ARP包"></p>
<p><strong>硬件类型：</strong> 数据链路层使用的类型数据，多数情况下是以太网（类型1）</p>
<p><strong>协议类型：</strong> ARP请求正在使用的高层协议</p>
<p><strong>硬件地址长度：</strong>正在使用的硬件地址的长度（八位组/字节）</p>
<p><strong>协议地址长度：</strong>对于制定协议类型所使用的逻辑地址的长度（八位组/字节）</p>
<p><strong>操作：</strong> ARP数据包的功能：<strong>1</strong>表示请求，<strong>2</strong>表示响应</p>
<p><strong>发送方硬件地址：</strong>发送者的硬件地址</p>
<p><strong>发送方协议地址：</strong>发送者的高层协议地址</p>
<p><strong>目标硬件地址：</strong>目标接收方的硬件地址（ARP请求中为<strong>0</strong>）</p>
<p><strong>目标协议地址：</strong>目标接收方的高层协议地址</p>
<h3 id="数据包分析"><a href="#数据包分析" class="headerlink" title="数据包分析"></a>数据包分析</h3><p><strong>数据包 1：ARP请求</strong></p>
<p><strong>数据包 2：ARP响应</strong></p>
<p><strong>无偿的ARP</strong></p>
<hr>
<h2 id="0x02-IP协议分析"><a href="#0x02-IP协议分析" class="headerlink" title="0x02 IP协议分析"></a>0x02 IP协议分析</h2><h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>IP是TCP/IP协议族中最为核心的协议，所有的TCP、UDP、ICMP及IGMP数据都以IP数据报格式传输，IP提供<strong>不可靠</strong>、<strong>无连接</strong>的数据报传送服务</p>
<p><strong>不可靠（unreliable）</strong>的意思是它不能保证IP数据报能成功地到达目的地。IP仅提供最好的传输服务。如果发生某种错误时，如某个路由器暂时用完了缓冲区，IP有一个简单的错误处理算法：丢弃该数据报，然后发送ICMP消息报给信源端。任何要求的可靠性必须由上层来提供（如TCP）</p>
<p><strong>无连接（connectionless）</strong>这个术语的意思是IP并不维护任何关于后续数据报的状态信息。每个数据报的处理是相互独立的。这也说明，IP数据报可以不按发送顺序接收。如果一信源向相同的信宿发送两个连续的数据报（先是A，然后是B），每个数据报都是独立地进行路由选择，可能选择不同的路线，因此B可能在A到达之前先到达</p>
<h3 id="IP地址"><a href="#IP地址" class="headerlink" title="IP地址"></a>IP地址</h3><p><strong>功能：</strong> IP地址是一个32位地址，用来唯一标识连接到网络的设备</p>
<p><strong>表示：</strong> 点分十进制，以A.B.C.D的形式，构成IP地址的四组1和0分别转换为十进制0到255之间的数。</p>
<p><strong>网络掩码：</strong> 每个IP地址都包含两个部分：网络地址和主机地址，网络地址用来标识设备所连接到的局域网，之际地址表示这个网络的设备本身。这由网路掩码的地址决定，网络掩码长32位，设为1的每一位标识IP地址对应部分属于网络地址，剩下设为0的部分标识主机地址</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E6%8E%A9%E7%A0%81.png" alt="mask"></p>
<p><strong>CIDR表示法：</strong> IP地址和网络掩码位简便起见，常被写成无类型域间路由（Classless Inter-Domain Routing，<strong>CIDR</strong>）的形式。完整IP地址后有一左斜杠（/），以及一个用来表示IP地址中网络部分位数的数字。如IP地址10.10.1.22和网络掩码225.225.0.0，在CIDR表示法下被写成10.10.1.22/16的形式</p>
<h3 id="IP数据包结构"><a href="#IP数据包结构" class="headerlink" title="IP数据包结构"></a>IP数据包结构</h3><p><img src="http://paivdtahr.bkt.clouddn.com/IP%E6%8A%A5%E6%96%87.png" alt="IP"></p>
<p><strong>版本号（Version）:</strong> IP所使用的版本</p>
<p><strong>首部长度（Header Length）:</strong> IP头的长度</p>
<p><strong>服务类型（Type of Service）:</strong> 优先级标志位和服务类型标志位，被路由器用来进行流量的优先排序</p>
<p><strong>总长度（Total Length）:</strong> IP头与数据包中数据的长度</p>
<p><strong>标识符（Identification）:</strong> 一个唯一的标识数字，用来标识一个数据包或者被分片数据包的次序</p>
<p><strong>标记（Flags）:</strong>用来标记一个数据包是否是一组分片数据包的一部分</p>
<p><strong>分片偏移（Fragment Offset）：</strong> 一个数据包就是一个分片，这个域中的值就会被用来将数据包以正确的形式重新组装</p>
<p><strong>存活时间（Time to Live）:</strong> 用来定义数据包的生存周期，以经过路由器的跳数/秒数进行描述</p>
<p><strong>协议（Protocol）:</strong> 用来标识在数据包系列中上层协议数据包的类型</p>
<p><strong>首部校验和（Header Checksum）:</strong> 一个错误检测机制，用来确认IP头的内容没有被损坏或者篡改</p>
<p><strong>源IP地址（Source IP Address）:</strong> 发出数据包的主机IP地址</p>
<p><strong>目的IP地址（Destination IP Address）</strong> 数据包目的地的IP地址</p>
<p><strong>选项（Options）:</strong> 保留为额外的IP选项，它包含着源站选路和时间戳的一些选项</p>
<p><strong>数据（Data）:</strong> 使用IP传递的实际数据</p>
<h3 id="存活时间分析"><a href="#存活时间分析" class="headerlink" title="存活时间分析"></a>存活时间分析</h3><p><strong>简述：</strong> 存活时间（TTL）值定义了在该数据包丢弃之前，所能经历的时间，或者能经过的最大的路由数目。TTL在数据包创建时被定义，通常在每次被发往一个路由器的时候减1，当TTL减为0时，如果这个数据包的最终目的地不再这个网络中，则此数据包将会被丢弃</p>
<p><strong>实例分析</strong></p>
<h3 id="IP分片分析"><a href="#IP分片分析" class="headerlink" title="IP分片分析"></a>IP分片分析</h3><p><strong>简述：</strong> 数据包分片是将一个数据流分为更小的片段，是IP解决跨域不同类型网络是可靠传输的一个特性。一个数据包的分片主要是基于第二层数据链路协议所使用的最大传输单元（Maximum Transmission Unit，<strong>MTU</strong>）的大小，以及使用这些第二层协议的设备配置情况。</p>
<p><strong>MTU：</strong> 数据链路层协议多用以太网，<br>其默认MTU为1500，即以太网的网络上所能传输的最大数据包大小为1500字节（不包括14字节的以太网头本身）。MTU是基于接口进行设定，通常可以手工修改</p>
<p><strong>分片原理：</strong> 当一个设备准备传输一个 IP数据包时，它会比较这个数据包的大小，以及将要把这个数据包传送出去的网络接口MTU，用于决定是否要将此数据包分片。如果数据包的大小大于MTU，那么这个数据包就会被分片</p>
<p><strong>分片步骤</strong></p>
<ol>
<li>设备数据分为若干个可成功进行传输的数据包</li>
<li>每个IP头的总长度域会被设置为每个分片的片段长度</li>
<li>更多分片标志将会被数据流所有的数据包中设置为1，除了最后一个数据包</li>
<li>IP头重分片部分的分片偏移将会被设置</li>
<li>数据包被发送出去</li>
</ol>
<p><strong>实例分析</strong></p>
<hr>
<h2 id="0x03-ICMP协议分析"><a href="#0x03-ICMP协议分析" class="headerlink" title="0x03 ICMP协议分析"></a>0x03 ICMP协议分析</h2><h3 id="简述-1"><a href="#简述-1" class="headerlink" title="简述"></a>简述</h3><p>互联网控制消息协议（Internet Control Message Protocol，ICMP）是互联网协议族的核心协议之一，它用于TCP/IP网络中发送控制消息，提供可能发生在通信环境中的各种问题反馈，通过这些信息，使管理者可以对所发生的问题作出诊断，然后采取适当的措施解决。ICMP依靠IP来完成它的任务，它是IP的主要部分，它与传输协议（如TCP和UDP）显著不同：它一般不用于在两点间传输数据，通常不由网络程序直接使用</p>
<h3 id="ICMP头"><a href="#ICMP头" class="headerlink" title="ICMP头"></a>ICMP头</h3><p><img src="http://paivdtahr.bkt.clouddn.com/ICMP.png" alt="ICMP"></p>
<p><strong>类型（Type）:</strong>ICMP的类型,标识生成的错误报文</p>
<p><strong>代码（Code）:</strong>进一步划分ICMP的类型,该字段用来查找产生错误的原因</p>
<p><strong>校验和（Checksum）:</strong>用来保证ICMP头和数据抵达目的地时的完整性</p>
<p><strong>可变域（Variable）:</strong>依赖于类型和代码域的部分</p>
<h3 id="ICMP报文类型"><a href="#ICMP报文类型" class="headerlink" title="ICMP报文类型"></a>ICMP报文类型</h3><p><img src="http://paivdtahr.bkt.clouddn.com/ICMP%E7%B1%BB%E5%9E%8B.png" alt="ICMP"></p>
<h3 id="Echo请求与响应"><a href="#Echo请求与响应" class="headerlink" title="Echo请求与响应"></a>Echo请求与响应</h3><h3 id="路由跟踪"><a href="#路由跟踪" class="headerlink" title="路由跟踪"></a>路由跟踪</h3><hr>
<h2 id="0x04-TCP协议分析"><a href="#0x04-TCP协议分析" class="headerlink" title="0x04 TCP协议分析"></a>0x04 TCP协议分析</h2><h3 id="简述-2"><a href="#简述-2" class="headerlink" title="简述"></a>简述</h3><p>TCP提供一种<strong>面向连接的</strong>、<strong>可靠的</strong>字节流服务。面向连接意味着两个使用TCP的应用（通常是一个客户和一个服务器）在彼此交换数据之前必须先建立一个TCP连接</p>
<h3 id="TCP头部"><a href="#TCP头部" class="headerlink" title="TCP头部"></a>TCP头部</h3><p><img src="http://paivdtahr.bkt.clouddn.com/TCP%E5%A4%B4%E9%83%A8.png" alt="TCP头部"></p>
<p><strong>源端口（Source Port）:</strong> 用于传输数据包的端口</p>
<p><strong>目的端口（Destination Port）:</strong> 数据包将要被发送到的端口</p>
<p><strong>序号（Sequence Number）:</strong> 用于表示一个TCP片段，这个域用来保证数据流中的部分没有缺失</p>
<p><strong>确认号（Acknowledgement Number）:</strong> 此数字是通信中希望从另一个设备得到的下一个数据包的序号</p>
<p><strong>标记（Flag）:</strong> URG,ACK,PSH,RST,SYN 和 FIN 标记都是用来表示所传输的TCP数据包的类型</p>
<p><strong>窗口大小（Window Size）:</strong> TCP接收者缓冲的字节大小</p>
<p><strong>校验和（Checksum）:</strong> 用来保证TCP头和数据的内容在抵达目的地时的完整性</p>
<p><strong>紧急指针（Urgent Pointer）:</strong> 如果设置了URG位，这个域将被检查作为额外的指令，告诉CPU从数据包的哪里开始读取数据</p>
<p><strong>选项（Options）:</strong> 各种可选的域，可以在TCP数据包中进行指定</p>
<h3 id="TCP端口分析"><a href="#TCP端口分析" class="headerlink" title="TCP端口分析"></a>TCP端口分析</h3><p><strong>TCP使用端口传输数据</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/TCP%E7%AB%AF%E5%8F%A3.png" alt="port"></p>
<p><strong>端口分类（TCP通信角度）</strong></p>
<p><strong>1~1023：</strong>标准端口组（忽略被预留的0），特定服务会用到这些通常位于标准端口分组中的标准端口</p>
<p><strong>1024~65535：</strong>临时端口组（<strong>1024~49151</strong> 称为注册端口：松散地绑定于一些服务，多数没有明确的定义服务对象，不同程序可根据实际需要自己定义；<strong>49152~65535</strong> 称为动态端口：一般不固定分配某种服务，而是动态分配）</p>
<p><strong><a href="http://tool.oschina.net/commons?type=7" title="常用端口列表" target="_blank" rel="noopener">常用端口列表</a></strong></p>
<p><strong>实例分析</strong></p>
<h3 id="TCP三次握手（建立连接）"><a href="#TCP三次握手（建立连接）" class="headerlink" title="TCP三次握手（建立连接）"></a>TCP三次握手（建立连接）</h3><p><strong>握手目的</strong></p>
<ol>
<li>保证源主机确定目的主机在线，并且可以进行通信</li>
<li>让源主机检查它是否正在监听试图去连接的端口</li>
<li>允许源主机向接收者发送它的其实序列号，是的两台主机可以将数据包流保持有序</li>
</ol>
<p><strong>握手过程</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.png" alt="三次"></p>
<ol>
<li><p><strong>第一阶段：</strong>Client将标志位SYN置为1，随机产生一个值seq=J，并将该数据包发送给Server，Client进入SYN_SENT状态，等待Server确认</p>
</li>
<li><p><strong>第二阶段：</strong>Server收到数据包后由标志位SYN=1知道Client请求建立连接，Server将标志位SYN和ACK都置为1，ack=J+1，随机产生一个值seq=K，并将该数据包发送给Client以确认连接请求，Server进入SYN_RCVD状态</p>
</li>
<li><p><strong>第三阶段：</strong>Client收到确认后，检查ack是否为J+1，ACK是否为1，如果正确则将标志位ACK置为1，ack=K+1，并将该数据包发送给Server，Server检查ack是否为K+1，ACK是否为1，如果正确则连接建立成功，Client和Server进入ESTABLISHED状态，完成三次握手，随后Client与Server之间可以开始传输数据</p>
</li>
</ol>
<p><strong>实例分析</strong></p>
<h3 id="TCP四次握手（终止连接）"><a href="#TCP四次握手（终止连接）" class="headerlink" title="TCP四次握手（终止连接）"></a>TCP四次握手（终止连接）</h3><p><strong>原因简析</strong></p>
<p>由于TCP连接时全双工的，因此，每个方向都必须要单独进行关闭，这一原则是当一方完成数据发送任务后，发送一个FIN来终止这一方向的连接，收到一个FIN只是意味着这一方向上没有数据流动了，即不会再收到数据了，但是在这个TCP连接上仍然能够发送数据，直到这一方向也发送了FIN。首先进行关闭的一方将执行主动关闭，而另一方则执行被动关闭</p>
<p><strong>握手过程</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/TCP%E5%9B%9B%E6%AC%A1%E6%8F%A1%E6%89%8B.png" alt="四次"></p>
<ol>
<li><p><strong>第一阶段：</strong>Client发送一个FIN，用来关闭Client到Server的数据传送，Client进入FIN_WAIT_1状态</p>
</li>
<li><p><strong>第二阶段：</strong>Server收到FIN后，发送一个ACK给Client，确认序号为收到序号+1（与SYN相同，一个FIN占用一个序号），Server进入CLOSE_WAIT状态</p>
</li>
<li><p><strong>第三阶段：</strong>Server发送一个FIN，用来关闭Server到Client的数据传送，Server进入LAST_ACK状态</p>
</li>
<li><p><strong>第四阶段：</strong>Client收到FIN后，Client进入TIME_WAIT状态，接着发送一个ACK给Server，确认序号为收到序号+1，Server进入CLOSED状态，完成四次挥手</p>
</li>
</ol>
<p><strong>实例分析</strong></p>
<hr>
<h2 id="0x05-UDP协议分析"><a href="#0x05-UDP协议分析" class="headerlink" title="0x05 UDP协议分析"></a>0x05 UDP协议分析</h2><h3 id="简述-3"><a href="#简述-3" class="headerlink" title="简述"></a>简述</h3><p>用户数据报协议（User Datagram Protocol,UDP）是一个简单的面向数据报的运输层协议，是一种尽力服务。UDP协议是无连接协议，不会正式地建立和结束主机之间的连接，也不存在握手和终止过程。UDP提供不可靠服务，主要是为了提供高速的传输，所以依赖于UDP的协议通常都会有其内置的可靠性服务，或者使用ICMP的一些功能来保证连接更可靠</p>
<h3 id="UDP头"><a href="#UDP头" class="headerlink" title="UDP头"></a>UDP头</h3><p><img src="http://paivdtahr.bkt.clouddn.com/UDP.png" alt="UDP"></p>
<p><strong>源端口：</strong>用来传输数据包的端口</p>
<p><strong>目标端口：</strong>数据包将要被传输到的端口</p>
<p><strong>数据包长度：</strong>数据包的字节长度</p>
<p><strong>校验和：</strong>用来确保UDP头和数据到达时的完整性</p>
<h3 id="实例分析"><a href="#实例分析" class="headerlink" title="实例分析"></a>实例分析</h3><hr>
<h2 id="0x06-DHCP协议分析"><a href="#0x06-DHCP协议分析" class="headerlink" title="0x06 DHCP协议分析"></a>0x06 DHCP协议分析</h2><h3 id="简述-4"><a href="#简述-4" class="headerlink" title="简述"></a>简述</h3><p>动态主机配置协议DHCP（Dynamic Host Configuration Protocol）是一个应用层协议，能够让设备自动获取IP地址（以及其他重要网络资源，比如DNS服务器和路由网关的地址），大多数的DHCP服务器都向客户端提供一些其他的参数，比如网络上的默认网关和DNS服务器的地址。</p>
<h3 id="DHCP头结构"><a href="#DHCP头结构" class="headerlink" title="DHCP头结构"></a>DHCP头结构</h3><p><img src="http://paivdtahr.bkt.clouddn.com/DHCP%E6%8A%A5%E6%96%87.png" alt="DHCP"></p>
<p><strong>操作代码（OpCode）：</strong>用来指出这个数据包时DHCP请求还是DHCP回复</p>
<p><strong>硬件类型（Hardware Type）：</strong>硬件地址类型（10MB以太网，IEEE802，ATM以及其他）</p>
<p><strong>跳数（Hops）：</strong>中继代理用来帮助寻找DHCP服务器</p>
<p><strong>事物ID（Transaction ID）：</strong>用来匹配请求和响应的一个随机数</p>
<p><strong>消耗时间（Seconds Elasped）：</strong>客户端第一次向DHCP服务器发出地址请求后时间</p>
<p><strong>标记（Flags）：</strong>DHCP能够接受的流量类型（单播，广播及其他）</p>
<p><strong>客户端IP地址（Client IP Address）：</strong>客户端的IP地址（由“你的”IP地址域派生）</p>
<p><strong>“你的”IP地址（Your IP Address）：</strong>DHCP服务器提供的地址（最终成为客户端IP地址域的值）</p>
<p><strong>服务器IP地址（Server IP Address）：</strong>DHCP服务器的IP地址</p>
<p><strong>网关IP地址（Gateway IP Address）：</strong>网络默认网关的IP地址</p>
<p><strong>客户端硬件地址（Client Hardware Address）：</strong>客户端的MAC地址</p>
<p><strong>服务器主机名（Server Host Name）：</strong>服务器主机名（可选）</p>
<p><strong>启动文件（Boot File）：</strong>DHCP所使用的启动文件（可选）</p>
<p><strong>选项（Options）：</strong>用来对DHCP数据包进行扩展，一提供更多功能</p>
<h3 id="DHCP续租过程"><a href="#DHCP续租过程" class="headerlink" title="DHCP续租过程"></a>DHCP续租过程</h3><p>DHCP最主要的任务就是在续租过程中想客户端分配IP地址，续租过程在一个客户端与DHCP服务器之间进行。DHCP的续租过程通常被成为DORA过程，它使用了4种类型的DHCP数据包：发现（Dicover），提供（Offer），请求（Request）和确认（Acknowledgement）</p>
<p>1 <strong>发现阶段</strong></p>
<p>DHCP客户机寻找DHCP服务器的阶段。DHCP客户机以广播方式（因为DHCP服务器的IP地址对于客户机来说是未知的）发送DHCP discover发现信息来寻找DHCP服务器，即向地址255.255.255.255发送特定的广播信息。网络上每一台安装了TCP/IP协议的主机都会接收到这种广播信息，但只有DHCP服务器才会做出响应</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E5%8F%91%E7%8E%B0.png" alt="discover"></p>
<p>2 <strong>提供阶段</strong></p>
<p>DHCP服务器提供IP地址的阶段。在网络中接收到DHCP discover发现信息的DHCP服务器都会做出响应，它从尚未出租的IP地址中挑选一个分配给DHCP客户机，向DHCP客户机发送一个包含出租的IP地址和其他设置的DHCP offer提供信息</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E6%8F%90%E4%BE%9B.png" alt="提供"></p>
<p>3 <strong>请求阶段</strong></p>
<p>DHCP客户机选择某台DHCP服务器提供的IP地址的阶段。如果有多台DHCP服务器向DHCP客户机发来的DHCP offer提供信息，则DHCP客户机只接受第一个收到的DHCP offer提供信息，然后它就以广播方式回答一个DHCP request请求信息，该信息中包含向它所选定的DHCP服务器请求IP地址的内容。之所以要以广播方式回答，是为了通知所有的DHCP服务器，他将选择某台DHCP服务器所提供的IP地址</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E8%AF%B7%E6%B1%82.png" alt="请求"></p>
<p>4 <strong>确认阶段</strong></p>
<p>DHCP服务器确认所提供的IP地址的阶段。当DHCP服务器收到DHCP客户机回答的DHCP request请求信息之后，它便向DHCP客户机发送一个包含它所提供的IP地址和其他设置的DHCP ack确认信息，告诉DHCP客户机可以使用它所提供的IP地址。然后DHCP客户机便将其TCP/IP协议与网卡绑定，另外，除DHCP客户机选中的服务器外，其他的DHCP服务器都将收回曾提供的IP地址</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E7%A1%AE%E8%AE%A4.png" alt="ack"></p>
<h3 id="选项和消息类型"><a href="#选项和消息类型" class="headerlink" title="选项和消息类型"></a>选项和消息类型</h3><p>DHCP依赖于其可选项来提供真正的灵活性，数据包的DHCP选项在大小和内容上都可以变化，数据包的整体大小则取决于其所使用的选项；所以DHCP数据包都需要唯一选项就是消息类型选项（选项53），这个选项标识着DHCP客户端或者服务器将如何处理数据包中的信息</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B.png" alt="消息"></p>
<hr>
<h2 id="0x07-DNS分析"><a href="#0x07-DNS分析" class="headerlink" title="0x07 DNS分析"></a>0x07 DNS分析</h2><h3 id="简述-5"><a href="#简述-5" class="headerlink" title="简述"></a>简述</h3><p>域名系统（DNS）是一种用于TCP/IP应用程序的分布式数据库，它提供主机名字和IP地址之间的转换及有关电子邮件的选路信息，DNS服务器存储了一个有着IP地址和DNS名字映射资源记录的数据库，并将其和客户端与其它DNS服务器共享</p>
<h3 id="DNS报文格式"><a href="#DNS报文格式" class="headerlink" title="DNS报文格式"></a>DNS报文格式</h3><p><img src="http://paivdtahr.bkt.clouddn.com/DNS.png" alt="DNS"></p>
<p><strong>DNS ID号（DNS ID Number）：</strong>用来对应DNS查询和DNS响应</p>
<p><strong>查询/响应（Query/Response）：</strong>用于知名报文是DNS查询还是响应</p>
<p><strong>操作代码（OpCode）：</strong>用于定义消息中请求的类型</p>
<p><strong>权威应答（Authoritative Answer，AA）：</strong>若设定此值，则说明此响应是由域内权威域名服务器发出的</p>
<p><strong>截断（Truncation，TC）：</strong>用于说明由于此响应太长，无法装入数据包而被截断</p>
<p><strong>期望递归（Recursion Desired，RD）：</strong>当请求中设定此值，则说明DNS客户端在目标域名服务器不含有请求消息的情况下，要求进行递归查询</p>
<p><strong>可用递归（Recurision Availiable，RA）：</strong>当响应中设定此值，说明域名服务器支持递归查询</p>
<p><strong>保留（Z）：</strong>全设为0，有时会用作RCode域的扩展</p>
<p><strong>响应代码（Response Code）：</strong>在DNS响应中用来指明错误</p>
<p><strong>问题计数（Question Count）：</strong>在问题区段中的条目数</p>
<p><strong>回答计数（Answer Count）：</strong>在回答区段中的条目数</p>
<p><strong>域名服务器计数（Name Server Count）：</strong>在权威区段的域名资源记录数</p>
<p><strong>额外记录计数（Additional Records Count）：</strong>在额外信息区段中其他资源记录数</p>
<p><strong>问题区段（Question section）：</strong>大小可变，包含有被发送带DNS服务器的一条或多条的信息查询的部分</p>
<p><strong>回答区段（Answer section）：</strong>大小可变，含有用来回答查询的额一条或多条资源记录</p>
<p><strong>权威区段（Authority section）：</strong>大小可变，包含指向权威域名服务器的资源记录，用以继续解析过程</p>
<p><strong>额外信息区段（Additional Information section）：</strong>包含资源记录且大小可变的区段，这些资源记录用来存储完全没有必要回答的查询相关的额外信息</p>
<h3 id="简单DNS查询"><a href="#简单DNS查询" class="headerlink" title="简单DNS查询"></a>简单DNS查询</h3><p>DNS以查询/响应的模式工作，当一个客户端轩昂要讲一个DNS名字解析成IP地址，它向DNS服务器发送一个查询，然后服务器会在响应中提供所请求的信息，最简单情况下，这个过程包含两个数据包</p>
<h3 id="DNS记录类型"><a href="#DNS记录类型" class="headerlink" title="DNS记录类型"></a>DNS记录类型</h3><p>DNS查询和响应中所使用的类型域，指明了这个查询或者响应的资源记录类型</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/DNS%E7%B1%BB%E5%9E%8B.png" alt="DNS"></p>
<h3 id="DNS递归分析"><a href="#DNS递归分析" class="headerlink" title="DNS递归分析"></a>DNS递归分析</h3><p><img src="http://paivdtahr.bkt.clouddn.com/DNS%E9%80%92%E5%BD%92.png" alt="递归"></p>
<h3 id="DNS区域传送"><a href="#DNS区域传送" class="headerlink" title="DNS区域传送"></a>DNS区域传送</h3><hr>
<h2 id="0x07-HTTP协议分析"><a href="#0x07-HTTP协议分析" class="headerlink" title="0x07 HTTP协议分析"></a>0x07 HTTP协议分析</h2><h3 id="使用HTTP浏览"><a href="#使用HTTP浏览" class="headerlink" title="使用HTTP浏览"></a>使用HTTP浏览</h3><h3 id="使用HTTP传送数据"><a href="#使用HTTP传送数据" class="headerlink" title="使用HTTP传送数据"></a>使用HTTP传送数据</h3><hr>
<h2 id="0xFF-拓展学习"><a href="#0xFF-拓展学习" class="headerlink" title="0xFF 拓展学习"></a>0xFF 拓展学习</h2><ul>
<li><a href="https://pan.baidu.com/s/1hYsSsjIOFrHE0M5LeCU9Rw" title="《TCP/IP 详解  卷一：协议》" target="_blank" rel="noopener">《TCP/IP 详解  卷一：协议》</a></li>
</ul>
<ul>
<li><p><a href="https://pan.baidu.com/s/1J7m75b3hFFvw9fKFXRE6cg" title="计算机网络：自顶向下方法" target="_blank" rel="noopener">《计算机网络：自顶向下方法》</a></p>
</li>
<li><p><a href="https://pan.baidu.com/s/1xxXjp8P2giFAYtXjt8uqMA" title="《数据通信与网络 第六版》" target="_blank" rel="noopener">《数据通信与网络 第六版》</a></p>
</li>
<li><p><a href="https://pan.baidu.com/s/1MOLX3DfDgbaThxcEqFZPfg" title="Wireshark数据包分析实战" target="_blank" rel="noopener">《Wireshark数据包分析实战》</a></p>
</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Network/" rel="tag"><i class="fa fa-tag"></i> Network</a>
          
            <a href="/tags/TCP-IP/" rel="tag"><i class="fa fa-tag"></i> TCP/IP</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/11/嗅探-Wireshark/" rel="next" title="嗅探-Wireshark">
                <i class="fa fa-chevron-left"></i> 嗅探-Wireshark
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Firehacker</p>
              <p class="site-description motion-element" itemprop="description">安全思维，技术，实践，分享</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-ARP协议分析"><span class="nav-number">1.</span> <span class="nav-text">0x01 ARP协议分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ARP协议概述"><span class="nav-number">1.1.</span> <span class="nav-text">ARP协议概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#APR解析过程"><span class="nav-number">1.2.</span> <span class="nav-text">APR解析过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ARP数据包结构"><span class="nav-number">1.3.</span> <span class="nav-text">ARP数据包结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据包分析"><span class="nav-number">1.4.</span> <span class="nav-text">数据包分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-IP协议分析"><span class="nav-number">2.</span> <span class="nav-text">0x02 IP协议分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简述"><span class="nav-number">2.1.</span> <span class="nav-text">简述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IP地址"><span class="nav-number">2.2.</span> <span class="nav-text">IP地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IP数据包结构"><span class="nav-number">2.3.</span> <span class="nav-text">IP数据包结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#存活时间分析"><span class="nav-number">2.4.</span> <span class="nav-text">存活时间分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IP分片分析"><span class="nav-number">2.5.</span> <span class="nav-text">IP分片分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-ICMP协议分析"><span class="nav-number">3.</span> <span class="nav-text">0x03 ICMP协议分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简述-1"><span class="nav-number">3.1.</span> <span class="nav-text">简述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ICMP头"><span class="nav-number">3.2.</span> <span class="nav-text">ICMP头</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ICMP报文类型"><span class="nav-number">3.3.</span> <span class="nav-text">ICMP报文类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Echo请求与响应"><span class="nav-number">3.4.</span> <span class="nav-text">Echo请求与响应</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#路由跟踪"><span class="nav-number">3.5.</span> <span class="nav-text">路由跟踪</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-TCP协议分析"><span class="nav-number">4.</span> <span class="nav-text">0x04 TCP协议分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简述-2"><span class="nav-number">4.1.</span> <span class="nav-text">简述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP头部"><span class="nav-number">4.2.</span> <span class="nav-text">TCP头部</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP端口分析"><span class="nav-number">4.3.</span> <span class="nav-text">TCP端口分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP三次握手（建立连接）"><span class="nav-number">4.4.</span> <span class="nav-text">TCP三次握手（建立连接）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP四次握手（终止连接）"><span class="nav-number">4.5.</span> <span class="nav-text">TCP四次握手（终止连接）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-UDP协议分析"><span class="nav-number">5.</span> <span class="nav-text">0x05 UDP协议分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简述-3"><span class="nav-number">5.1.</span> <span class="nav-text">简述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UDP头"><span class="nav-number">5.2.</span> <span class="nav-text">UDP头</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实例分析"><span class="nav-number">5.3.</span> <span class="nav-text">实例分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-DHCP协议分析"><span class="nav-number">6.</span> <span class="nav-text">0x06 DHCP协议分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简述-4"><span class="nav-number">6.1.</span> <span class="nav-text">简述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DHCP头结构"><span class="nav-number">6.2.</span> <span class="nav-text">DHCP头结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DHCP续租过程"><span class="nav-number">6.3.</span> <span class="nav-text">DHCP续租过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#选项和消息类型"><span class="nav-number">6.4.</span> <span class="nav-text">选项和消息类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-DNS分析"><span class="nav-number">7.</span> <span class="nav-text">0x07 DNS分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简述-5"><span class="nav-number">7.1.</span> <span class="nav-text">简述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS报文格式"><span class="nav-number">7.2.</span> <span class="nav-text">DNS报文格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#简单DNS查询"><span class="nav-number">7.3.</span> <span class="nav-text">简单DNS查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS记录类型"><span class="nav-number">7.4.</span> <span class="nav-text">DNS记录类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS递归分析"><span class="nav-number">7.5.</span> <span class="nav-text">DNS递归分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS区域传送"><span class="nav-number">7.6.</span> <span class="nav-text">DNS区域传送</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-HTTP协议分析"><span class="nav-number">8.</span> <span class="nav-text">0x07 HTTP协议分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用HTTP浏览"><span class="nav-number">8.1.</span> <span class="nav-text">使用HTTP浏览</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用HTTP传送数据"><span class="nav-number">8.2.</span> <span class="nav-text">使用HTTP传送数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0xFF-拓展学习"><span class="nav-number">9.</span> <span class="nav-text">0xFF 拓展学习</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Firehacker</span>

  
</div>


<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

  <!-- <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>
-->





        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
