<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="google-site-verification" content="wCoNEhJPwtNoql5k0PfiYmMR-rgvliWvNZyGItcI3w0" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Wireshark,TCP/IP," />





  <link rel="alternate" href="/atom.xml" title="Firehacker" type="application/atom+xml" />






<meta name="description" content="本文对常用TCP/IP网络协议进行简要总结，并用Wireshark——一个免费开源的网络数据包分析工具对其进行分析">
<meta name="keywords" content="Wireshark,TCP&#x2F;IP">
<meta property="og:type" content="article">
<meta property="og:title" content="TCP&#x2F;IP网络协议及分析">
<meta property="og:url" content="http://yoursite.top/2018/07/11/网络协议及分析/index.html">
<meta property="og:site_name" content="Firehacker">
<meta property="og:description" content="本文对常用TCP/IP网络协议进行简要总结，并用Wireshark——一个免费开源的网络数据包分析工具对其进行分析">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ARP%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ARP%E6%95%B0%E6%8D%AE%E5%8C%85.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/wireshark%E4%BD%8D%E7%BD%AE.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ARP%E8%AF%B7%E6%B1%82.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/request.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ARP%E5%93%8D%E5%BA%94.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E5%93%8D%E5%BA%94.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E6%8E%A9%E7%A0%81.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/wireshark.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/IPping.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/IP%E5%88%86%E7%89%87.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ip%E6%95%B0%E6%8D%AE%E5%8C%85.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/IP%E6%8A%A5%E6%96%87.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ICMP.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/echo.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ICMP-wire.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ICMP%E6%95%B0%E6%8D%AE%E5%8C%85.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/no-replay.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/icmp%E4%B8%8D%E5%AD%98%E5%9C%A8.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ICMP%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ICMP%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/ICMP%E8%AF%8A%E6%96%AD%E6%8A%A5%E6%96%87.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/request%E6%95%B0%E6%8D%AE%E5%8C%85.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/reply%E6%95%B0%E6%8D%AE%E5%8C%85.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/time-to-live.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E4%B8%BB%E6%9C%BA%E4%B8%8D%E5%8F%AF%E8%BE%BE.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/TCP%E7%AB%AF%E5%8F%A3.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/TCP%E5%9B%9B%E6%AC%A1%E6%8F%A1%E6%89%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/TCP%E6%8B%93%E6%89%91.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/fin-ack.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/syn.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/fin.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/TCP%E5%A4%B4%E9%83%A8.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/UDPhuanjing.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/QICQ.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/UDP.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/UDP%E6%95%B0%E6%8D%AE%E5%8C%85.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/DHCP%E6%8A%A5%E6%96%87.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/DHCP%E6%B5%81%E7%A8%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E5%8F%91%E7%8E%B0.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E6%8F%90%E4%BE%9B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E8%AF%B7%E6%B1%82.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E7%A1%AE%E8%AE%A4.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/DNS.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/DNS%E7%B1%BB%E5%9E%8B.png">
<meta property="og:image" content="http://paivdtahr.bkt.clouddn.com/DNS%E9%80%92%E5%BD%92.png">
<meta property="og:updated_time" content="2018-09-19T10:58:28.152Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TCP&#x2F;IP网络协议及分析">
<meta name="twitter:description" content="本文对常用TCP/IP网络协议进行简要总结，并用Wireshark——一个免费开源的网络数据包分析工具对其进行分析">
<meta name="twitter:image" content="http://paivdtahr.bkt.clouddn.com/ARP%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.top/2018/07/11/网络协议及分析/"/>





  <title>TCP/IP网络协议及分析 | Firehacker</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>
	
	<a href="https://github.com/Hackerfire" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Firehacker</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-aisec">
          <a href="/AISec/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-eye"></i> <br />
            
            AISec
          </a>
        </li>
      
        
        <li class="menu-item menu-item-community">
          <a href="/community/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-users"></i> <br />
            
            社区
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tools">
          <a href="/tools/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-wrench"></i> <br />
            
            工具
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/links" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-link"></i> <br />
            
            友链
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.top/2018/07/11/网络协议及分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Firehacker">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Firehacker">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">TCP/IP网络协议及分析</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-11T08:09:24+08:00">
                2018-07-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/0x02-原理浅析/" itemprop="url" rel="index">
                    <span itemprop="name">0x02 原理浅析</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/0x02-原理浅析/网络协议/" itemprop="url" rel="index">
                    <span itemprop="name">网络协议</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/07/11/网络协议及分析/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/07/11/网络协议及分析/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>本文对常用TCP/IP网络协议进行简要总结，并用<a href="https://www.wireshark.org/" title="Wireshark" target="_blank" rel="noopener">Wireshark</a>——一个免费开源的网络数据包分析工具对其进行分析</p>
</blockquote>
<a id="more"></a>
<hr>
<h2 id="0x01-ARP协议"><a href="#0x01-ARP协议" class="headerlink" title="0x01 ARP协议"></a>0x01 ARP协议</h2><h3 id="1-协议基础及原理"><a href="#1-协议基础及原理" class="headerlink" title="1. 协议基础及原理"></a>1. 协议基础及原理</h3><p><strong>(1) ARP协议概述</strong></p>
<p><strong>逻辑地址：</strong>使不同网络以及没有直接相连的设备之间能够进行通信</p>
<p><strong>物理地址：</strong>用来在单一网段中交换机直接连接的设备之间能够进行通信</p>
<p><strong>协议功能：</strong>将已知的IP地址解析成MAC地址，便于主机间能正常通信</p>
<p><strong>MAC地址通信原理：</strong> 网络中用于连接各个设备的交换机使用了<strong>内容寻址寄存器</strong>（CAM），这个表列出了它在每一个端口的所有连接设备的MAC地址，当交换机收到一个指向特定MAC地址的流量，它就会使用这个表，来确定应该使用哪一个端口发送流量。如果目标的MAC地址是未知的，这个传输设备会首先在它的缓存中查找这个地址，如果没有找到，那么这个地址就需要在网络上额外的通信来进行解析</p>
<p><strong>(2) APR解析过程</strong></p>
<p>解析过程使用两种数据包：一个<strong>ARP请求</strong>，一个<strong>ARP响应</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ARP%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B.png" alt="ARP"></p>
<p><strong>ARP请求：</strong>传输计算机发出ARP请求，发送源IP地址，源MAC地址，目的IP地址，将此数据包广播给网段中的所有设备，请求拥有目的IP对应的MAC地址</p>
<p><strong>ARP响应：</strong>非此目的IP地址的设备将简单丢弃这个数据包，而拥有这个IP地址的设备将发送一个ARP响应，将MAC地址发送至传输计算机</p>
<p>解析完成后，传输设备对这个设备MAC与IP对应关系的缓存进行更新，并开始传输数据</p>
<p><strong>(3) ARP缓存表</strong></p>
<p><strong>概念：</strong>ARP缓存中包含一个或多个表，用于存储IP地址及其解析过的MAC地址。</p>
<p><strong>ARP命令：</strong>用于查询本机ARP缓存中的IP地址和MAC地址的对应关系，添加或删除静态对应关系，也可用于验证ARP缓存条目的生命周期；windows下亦可用netsh命令绑定IP-MAC地址</p>
<p><strong>Windows-ARP</strong></p>
<pre><code>ARP -s inet_addr eth_addr [if_addr]
ARP -d inet_addr [if_addr]
ARP -a [inet_addr] [-N if_addr] [-v]

-a            通过询问当前协议数据，显示当前 ARP 项，如果指定 inet_addr，则只显示指定计算机的 IP 地址和物理地址。如果不止一个网络接口使用 ARP，则显示每个 ARP 表的项

-g            与 -a 相同

-v            在详细模式下显示当前 ARP 项，所有无效项和环回接口上的项都将显示

inet_addr     指定 Internet 地址

-N if_addr    显示 if_addr 指定的网络接口的 ARP 项

-d            删除 inet_addr 指定的主机，inet_addr 可以是通配符 *，以删除所有主机

-s            添加主机并且将 Internet 地址 inet_addr与物理地址 eth_addr 相关联，物理地址是用连字符分隔的 6 个十六进制字节。该项是永久的

eth_addr      指定物理地址

if_addr       如果存在，此项指定地址转换表应修改的接口的 Internet 地址。如果不存在，则使用第一个适用的接口
</code></pre><p><strong>Windows-Netsh</strong></p>
<pre><code>用法: netsh [-a AliasFile] [-c Context] [-r RemoteMachine] [-u [DomainName\]UserName] [-p Password | *]
             [Command | -f ScriptFile]

下列指令有效:

此上下文中的命令:
?              - 显示命令列表。
add            - 在项目列表上添加一个配置项目。
advfirewall    - 更改到 `netsh advfirewall&apos; 上下文。
bridge         - 更改到 `netsh bridge&apos; 上下文。
delete         - 在项目列表上删除一个配置项目。
dhcpclient     - 更改到 `netsh dhcpclient&apos; 上下文。
dnsclient      - 更改到 `netsh dnsclient&apos; 上下文。
dump           - 显示一个配置脚本。
exec           - 运行一个脚本文件。
firewall       - 更改到 `netsh firewall&apos; 上下文。
help           - 显示命令列表。
http           - 更改到 `netsh http&apos; 上下文。
interface      - 更改到 `netsh interface&apos; 上下文。
ipsec          - 更改到 `netsh ipsec&apos; 上下文。
lan            - 更改到 `netsh lan&apos; 上下文。
mbn            - 更改到 `netsh mbn&apos; 上下文。
namespace      - 更改到 `netsh namespace&apos; 上下文。
netio          - 更改到 `netsh netio&apos; 上下文。
p2p            - 更改到 `netsh p2p&apos; 上下文。
ras            - 更改到 `netsh ras&apos; 上下文。
rpc            - 更改到 `netsh rpc&apos; 上下文。
set            - 更新配置设置。
show           - 显示信息。
trace          - 更改到 `netsh trace&apos; 上下文。
wcn            - 更改到 `netsh wcn&apos; 上下文。
wfp            - 更改到 `netsh wfp&apos; 上下文。
winhttp        - 更改到 `netsh winhttp&apos; 上下文。
winsock        - 更改到 `netsh winsock&apos; 上下文。
wlan           - 更改到 `netsh wlan&apos; 上下文。
</code></pre><p><strong>Linux-ARP</strong></p>
<pre><code>Usage:
  arp [-vn]  [&lt;HW&gt;] [-i &lt;if&gt;] [-a] [&lt;hostname&gt;]             &lt;-Display ARP cache
  arp [-v]          [-i &lt;if&gt;] -d  &lt;host&gt; [pub]               &lt;-Delete ARP entry
  arp [-vnD] [&lt;HW&gt;] [-i &lt;if&gt;] -f  [&lt;filename&gt;]            &lt;-Add entry from file
  arp [-v]   [&lt;HW&gt;] [-i &lt;if&gt;] -s  &lt;host&gt; &lt;hwaddr&gt; [temp]            &lt;-Add entry
  arp [-v]   [&lt;HW&gt;] [-i &lt;if&gt;] -Ds &lt;host&gt; &lt;if&gt; [netmask &lt;nm&gt;] pub          &lt;-&apos;&apos;-

    -a                       display (all) hosts in alternative (BSD) style
    -e                       display (all) hosts in default (Linux) style
    -s, --set                set a new ARP entry
    -d, --delete             delete a specified entry
    -v, --verbose            be verbose
    -n, --numeric            don&apos;t resolve names
    -i, --device             specify network interface (e.g. eth0)
    -D, --use-device         read &lt;hwaddr&gt; from given device
    -A, -p, --protocol       specify protocol family
    -f, --file               read new entries from file or from /etc/ethers

  &lt;HW&gt;=Use &apos;-H &lt;hw&gt;&apos; to specify hardware address type. Default: ether
  List of possible hardware types (which support ARP):
    ash (Ash) ether (Ethernet) ax25 (AMPR AX.25) 
    netrom (AMPR NET/ROM) rose (AMPR ROSE) arcnet (ARCnet) 
    dlci (Frame Relay DLCI) fddi (Fiber Distributed Data Interface) hippi (HIPPI) 
    irda (IrLAP) x25 (generic X.25) eui64 (Generic EUI-64) 
</code></pre><p><strong>实例分析</strong></p>
<pre><code>1.使用netsh绑定IP和MAC地址

(1) 查看接口Idx号,假设为A

netsh i i show in

(2) 添加IP-MAC地址绑定

netsh -c &quot;i i&quot; add neighbors A &quot;ip&quot; &quot;MAC&quot;

(3) 使用arp -a 查看绑定的ARP条目

2.添加IP地址为192.168.1.1和MAC地址为00-aa-00-62-c6-09至缓存记录

arp -s 192.168.1.1 00-aa-00-62-c6-09

手动添加的ARP缓存条目默认为静态

3.删除IP地址为192.168.1.1的ARP记录

arp -d 192.168.1.1 

4.清空所有ARP条目

arp -d 或 arp -d *

在Linux下删除ARP缓存条目时必须制定接口地址
</code></pre><p><strong>(4) ARP数据包结构</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ARP%E6%95%B0%E6%8D%AE%E5%8C%85.png" alt="ARP包"></p>
<pre><code>硬件类型： 数据链路层使用的类型数据，多数情况下是以太网（类型1）

协议类型： ARP请求正在使用的高层协议

硬件地址长度：正在使用的硬件地址的长度（八位组/字节）

协议地址长度：对于制定协议类型所使用的逻辑地址的长度（八位组/字节）

操作：ARP数据包的功能：1表示请求，2表示响应

发送方硬件地址：发送者的硬件地址

发送方协议地址：发送者的高层协议地址

目标硬件地址：目标接收方的硬件地址（ARP请求中为0）

目标协议地址：目标接收方的高层协议地址
</code></pre><h3 id="2-ARP协议包捕获及分析"><a href="#2-ARP协议包捕获及分析" class="headerlink" title="2. ARP协议包捕获及分析"></a>2. ARP协议包捕获及分析</h3><p><strong>(1) 网络环境</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/wireshark%E4%BD%8D%E7%BD%AE.png" alt="ARP"></p>
<p>可选择与路由器直接通信，也可使用两台PC通信来产生ARP数据包</p>
<p><strong>(2) 使用捕获过滤器</strong></p>
<pre><code>1.在主机pc1上启动wireshark，设置捕获条件，然后start

2.使用捕获过滤器仅捕获ARP包，ARP包不会主动发送，需主机间进行通信；在主机PC2上执行ping命令，来产生ARP包供Wiresahrk捕获

3.who has ip_1? tell ip_2 帧为ARP请求包(ip_2主机请求IP为ip_1的MAC地址)；ip_1 is at MAC_1帧为ARP响应包(IP为ip_1的主机响应，传送MAC_1)
</code></pre><p><strong>(3) ARP协议报文</strong></p>
<p><strong>ARP请求协议报文</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ARP%E8%AF%B7%E6%B1%82.png" alt="request"></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/request.png" alt=""></p>
<p><strong>ARP响应协议报文</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ARP%E5%93%8D%E5%BA%94.png" alt="reply"></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E5%93%8D%E5%BA%94.png" alt=""></p>
<hr>
<h2 id="0x02-IP协议"><a href="#0x02-IP协议" class="headerlink" title="0x02 IP协议"></a>0x02 IP协议</h2><h3 id="1-协议原理及基础"><a href="#1-协议原理及基础" class="headerlink" title="1. 协议原理及基础"></a>1. 协议原理及基础</h3><p><strong>(1) 简述</strong></p>
<p>IP是TCP/IP协议族中最为核心的协议，所有的TCP、UDP、ICMP及IGMP数据都以IP数据报格式传输，IP提供<strong>不可靠</strong>、<strong>无连接</strong>的数据报传送服务</p>
<p><strong>不可靠（unreliable）</strong>的意思是它不能保证IP数据报能成功地到达目的地。IP仅提供最好的传输服务。如果发生某种错误时，如某个路由器暂时用完了缓冲区，IP有一个简单的错误处理算法：丢弃该数据报，然后发送ICMP消息报给信源端。任何要求的可靠性必须由上层来提供（如TCP）</p>
<p><strong>无连接（connectionless）</strong>这个术语的意思是IP并不维护任何关于后续数据报的状态信息。每个数据报的处理是相互独立的。这也说明，IP数据报可以不按发送顺序接收。如果一信源向相同的信宿发送两个连续的数据报（先是A，然后是B），每个数据报都是独立地进行路由选择，可能选择不同的路线，因此B可能在A到达之前先到达</p>
<p><strong>(2) IP地址</strong></p>
<p><strong>功能：</strong> IP地址是一个32位地址，用来唯一标识连接到网络的设备</p>
<p><strong>表示：</strong> 点分十进制，以A.B.C.D的形式，构成IP地址的四组1和0分别转换为十进制0到255之间的数。</p>
<p><strong>网络掩码：</strong> 每个IP地址都包含两个部分：网络地址和主机地址，网络地址用来标识设备所连接到的局域网，之际地址表示这个网络的设备本身。这由网路掩码的地址决定，网络掩码长32位，设为1的每一位标识IP地址对应部分属于网络地址，剩下设为0的部分标识主机地址</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E6%8E%A9%E7%A0%81.png" alt="mask"></p>
<p><strong>CIDR表示法：</strong> IP地址和网络掩码位简便起见，常被写成无类型域间路由（Classless Inter-Domain Routing，<strong>CIDR</strong>）的形式。完整IP地址后有一左斜杠（/），以及一个用来表示IP地址中网络部分位数的数字。如IP地址10.10.1.22和网络掩码225.225.0.0，在CIDR表示法下被写成10.10.1.22/16的形式</p>
<p><strong>(3) 存活时间</strong></p>
<p>存活时间（<strong>TTL</strong>）值定义了在该数据包丢弃之前，所能经历的时间，或者能经过的最大的路由数目。TTL在数据包创建时被定义，通常在每次被发往一个路由器的时候减1，当TTL减为0时，如果这个数据包的最终目的地不再这个网络中，则此数据包将会被丢弃</p>
<p><strong>(4) IP分片分析</strong></p>
<p><strong>简述：</strong> 数据包分片是将一个数据流分为更小的片段，是IP解决跨域不同类型网络是可靠传输的一个特性。一个数据包的分片主要是基于第二层数据链路协议所使用的最大传输单元（Maximum Transmission Unit，<strong>MTU</strong>）的大小，以及使用这些第二层协议的设备配置情况。</p>
<p><strong>MTU：</strong> 数据链路层协议多用以太网，<br>其默认MTU为1500，即以太网的网络上所能传输的最大数据包大小为1500字节（不包括14字节的以太网头本身）。MTU是基于接口进行设定，通常可以手工修改</p>
<p><strong>分片原理：</strong> 当一个设备准备传输一个 IP数据包时，它会比较这个数据包的大小，以及将要把这个数据包传送出去的网络接口MTU，用于决定是否要将此数据包分片。如果数据包的大小大于MTU，那么这个数据包就会被分片</p>
<p><strong>分片步骤</strong></p>
<pre><code>1. 设备数据分为若干个可成功进行传输的数据包
2. 每个IP头的总长度域会被设置为每个分片的片段长度
3. 更多分片标志将会被数据流所有的数据包中设置为1，除了最后一个数据包
4. IP头重分片部分的分片偏移将会被设置
5. 数据包被发送出去
</code></pre><h3 id="2-IP数据报捕获及分析"><a href="#2-IP数据报捕获及分析" class="headerlink" title="2. IP数据报捕获及分析"></a>2. IP数据报捕获及分析</h3><p><strong>(1) 网络环境</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/wireshark.png" alt=""></p>
<p>使用两个路由器(可证明TTL值的变化)，将三台主机分割为两个网段</p>
<p><strong>(2) 捕获IP数据包</strong></p>
<pre><code>1. Capture|Options设置捕获条件

2. 访问网页或者执行ping命令(以免捕获大量数据包)

3. 访问网页捕获到DNS,TCP,HTTP等协议的包都包含有IP头部详细信息

4. 设置显示过滤条件，可查看特定IP的协议包
</code></pre><p><img src="http://paivdtahr.bkt.clouddn.com/IPping.png" alt=""></p>
<p><strong>(3) 捕获IP分片数据包</strong></p>
<p>如果一个数据包超过1500个字节，就需要将该包进行分片发送，通过使用ICMP包来产生IP分片数据包(IP首部占用20字节，ICMP首部占用8字节，所捕获到的ICMP包大小最大为1472字节，需指定发送的ICMP包大于1472字节)</p>
<p><strong>Windows：</strong> <code>ping ip -l size</code></p>
<p><strong>Linux：</strong><code>ping ip -s packetsize</code></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/IP%E5%88%86%E7%89%87.png" alt=""></p>
<p><strong>(4) IP数据包分析</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ip%E6%95%B0%E6%8D%AE%E5%8C%85.png" alt=""></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/IP%E6%8A%A5%E6%96%87.png" alt="IP"></p>
<pre><code>版本号（Version）: IP所使用的版本

首部长度（Header Length）: IP头的长度

服务类型（Type of Service）: 优先级标志位和服务类型标志位，被路由器用来进行流量的优先排序

总长度（Total Length）: IP头与数据包中数据的长度

标识符（Identification）: 一个唯一的标识数字，用来标识一个数据包或者被分片数据包的次序

标记（Flags）: 用来标记一个数据包是否是一组分片数据包的一部分

分片偏移（Fragment Offset）：一个数据包就是一个分片，这个域中的值就会被用来将数据包以正确的形式重新组装

存活时间（Time to Live）: 用来定义数据包的生存周期，以经过路由器的跳数/秒数进行描述

协议（Protocol）: 用来标识在数据包系列中上层协议数据包的类型

首部校验和（Header Checksum）: 一个错误检测机制，用来确认IP头的内容没有被损坏或者篡改

源IP地址（Source IP Address）: 发出数据包的主机IP地址

目的IP地址（Destination IP Address）：数据包目的地的IP地址

选项（Options）: 保留为额外的IP选项，它包含着源站选路和时间戳的一些选项

数据（Data）: 使用IP传递的实际数据
</code></pre><hr>
<h2 id="0x03-ICMP协议"><a href="#0x03-ICMP协议" class="headerlink" title="0x03 ICMP协议"></a>0x03 ICMP协议</h2><h3 id="1-协议原理及基础-1"><a href="#1-协议原理及基础-1" class="headerlink" title="1. 协议原理及基础"></a>1. 协议原理及基础</h3><p><strong>(1) 协议简述</strong></p>
<p>互联网控制报文协议（Internet Control Message Protocol，ICMP）是互联网协议族的核心协议之一，是一种面向<strong>无连接</strong>的协议，它是TCP/IP协议族的一个子协议，用于IP主机，路由器直接传递控制消息。控制消息是指网络通不通，主机是否可达，路由是否可用等网络消息。</p>
<p><strong>(2) </strong>ICMP协议头部</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ICMP.png" alt="ICMP"></p>
<pre><code>类型（Type）: ICMP的类型,标识生成的错误报文

代码（Code）: 进一步划分ICMP的类型,该字段用来查找产生错误的原因

校验和（Checksum）: 用来保证ICMP头和数据抵达目的地时的完整性

可变域（Variable）: 依赖于类型和代码域的部分
</code></pre><p><strong>(3) Echo请求与响应</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/echo.png" alt=""></p>
<p>ping每次想一个设备发送一个数据包，并等待回复，以确定设备是否可连接；当主机A向主机B发送一个Echo Ping 请求包时，主机B就会向主机A发送一个Echo Ping 响应包</p>
<h3 id="2-ICMP协议包捕获"><a href="#2-ICMP协议包捕获" class="headerlink" title="2. ICMP协议包捕获"></a>2. ICMP协议包捕获</h3><p><strong>(1) 网络环境</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ICMP-wire.png" alt=""></p>
<p><strong>(2) 捕获正常ICMP数据包</strong></p>
<pre><code>1. 启动wireshark工具，设置捕获过滤条件

2. 配置信息设置完后，单击star开始捕获数据

3. 在PC1主机上执行ping命令来捕获ICMP数据包
</code></pre><p><img src="http://paivdtahr.bkt.clouddn.com/ICMP%E6%95%B0%E6%8D%AE%E5%8C%85.png" alt=""></p>
<p><strong>(3) 捕获请求超时的数据包</strong></p>
<p>当网络连通性不好时，执行ping命令，会返回请求超时的数据包，默认情况下ping命令发出Echo ping请求后，若2秒内未收到Echo ping响应，就会收到超时的数据包</p>
<pre><code>1. 启动wireshark工具，设置捕获过滤条件

2. 配置信息设置完后，单击star开始捕获数据

3. 执行tracert命令，捕获响应超时的数据包(Linux 下执行 traceroute -I ip)
</code></pre><p><img src="http://paivdtahr.bkt.clouddn.com/no-replay.png" alt=""></p>
<p>在Packet List面板中的Info列可以看到某些包信息为<strong>Time-to-live execded</strong>(超时)，表示该包响应超时</p>
<p><strong>(4) 捕获目标主机不可达的数据包</strong></p>
<p>当中间路由器不能给数据包找到路由或目的主机不能交付数据包时，中间路由器或目的主机将会丢弃这个数据包，然后，发出数据包的源点发送目标主机不可达的报文</p>
<ol>
<li><p>启动wireshark工具，设置捕获过滤条件</p>
</li>
<li><p>配置信息设置完后，单击star开始捕获数据</p>
</li>
<li><p>在PC1主机上执行ping命令，ping一个不存在的主机，将会捕获到目标主机不可达的数据包</p>
</li>
</ol>
<p><img src="http://paivdtahr.bkt.clouddn.com/icmp%E4%B8%8D%E5%AD%98%E5%9C%A8.png" alt=""></p>
<h3 id="3-ICMP报文类型"><a href="#3-ICMP报文类型" class="headerlink" title="3. ICMP报文类型"></a>3. ICMP报文类型</h3><p><strong>(1) ICMP请求报文类型</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ICMP%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87.png" alt=""></p>
<p><strong>(2) ICMP响应报文类型</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ICMP%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87.png" alt=""></p>
<p><strong>(3) ICMP协议提供的诊断报文类型</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/ICMP%E8%AF%8A%E6%96%AD%E6%8A%A5%E6%96%87.png" alt=""></p>
<h3 id="4-ICMP数据包分析"><a href="#4-ICMP数据包分析" class="headerlink" title="4. ICMP数据包分析"></a>4. ICMP数据包分析</h3><p><strong>(1) Echo Ping 请求包</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/request%E6%95%B0%E6%8D%AE%E5%8C%85.png" alt=""></p>
<p><strong>(2) Echo Ping 响应包</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/reply%E6%95%B0%E6%8D%AE%E5%8C%85.png" alt=""></p>
<p><strong>(3) 请求超时数据包</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/time-to-live.png" alt=""></p>
<p><strong>(4) 目标主机不可达数据包</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E4%B8%BB%E6%9C%BA%E4%B8%8D%E5%8F%AF%E8%BE%BE.png" alt=""></p>
<hr>
<h2 id="0x04-TCP协议"><a href="#0x04-TCP协议" class="headerlink" title="0x04 TCP协议"></a>0x04 TCP协议</h2><h3 id="1-协议基础及简述"><a href="#1-协议基础及简述" class="headerlink" title="1. 协议基础及简述"></a>1. 协议基础及简述</h3><p><strong>(1) 简述</strong></p>
<p>TCP提供一种<strong>面向连接的</strong>、<strong>可靠的</strong>字节流服务。面向连接意味着两个使用TCP的应用（通常是一个客户和一个服务器）在彼此交换数据之前必须先建立一个TCP连接，它能够处理数据的顺序和错误恢复，并最终保证数据能够达到其应达到的地方</p>
<p><strong>(2) TCP端口</strong></p>
<p><strong>TCP使用端口传输数据</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/TCP%E7%AB%AF%E5%8F%A3.png" alt="port"></p>
<p><strong>端口分类（TCP通信角度）</strong></p>
<p><strong>1~1023：</strong>标准端口组（忽略被预留的0），特定服务会用到这些通常位于标准端口分组中的标准端口</p>
<p><strong>1024~65535：</strong>临时端口组（<strong>1024~49151</strong> 称为注册端口：松散地绑定于一些服务，多数没有明确的定义服务对象，不同程序可根据实际需要自己定义；<strong>49152~65535</strong> 称为动态端口：一般不固定分配某种服务，而是动态分配）</p>
<p><strong><a href="http://tool.oschina.net/commons?type=7" title="常用端口列表" target="_blank" rel="noopener">常用端口列表</a></strong></p>
<p><strong>实例分析</strong></p>
<p><strong>(3) TCP三次握手（建立连接）</strong></p>
<p><strong>握手目的</strong></p>
<pre><code>1. 保证源主机确定目的主机在线，并且可以进行通信

2. 让源主机检查它是否正在监听试图去连接的端口

3. 允许源主机向接收者发送它的其实序列号，是的两台主机可以将数据包流保持有序
</code></pre><p><strong>握手过程</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.png" alt="三次"></p>
<ol>
<li><p><strong>第一阶段：</strong>Client将标志位SYN置为1，随机产生一个值seq=J，并将该数据包发送给Server，Client进入SYN_SENT状态，等待Server确认</p>
</li>
<li><p><strong>第二阶段：</strong>Server收到数据包后由标志位SYN=1知道Client请求建立连接，Server将标志位SYN和ACK都置为1，ack=J+1，随机产生一个值seq=K，并将该数据包发送给Client以确认连接请求，Server进入SYN_RCVD状态</p>
</li>
<li><p><strong>第三阶段：</strong>Client收到确认后，检查ack是否为J+1，ACK是否为1，如果正确则将标志位ACK置为1，ack=K+1，并将该数据包发送给Server，Server检查ack是否为K+1，ACK是否为1，如果正确则连接建立成功，Client和Server进入ESTABLISHED状态，完成三次握手，随后Client与Server之间可以开始传输数据</p>
</li>
</ol>
<p><strong>(4) TCP四次握手（终止连接）</strong></p>
<p><strong>原因简析</strong></p>
<p>由于TCP连接时<strong>全双工</strong>的，因此，每个方向都必须要单独进行关闭，这一原则是当一方完成数据发送任务后，发送一个<strong>FIN</strong>来终止这一方向的连接，收到一个FIN只是意味着这一方向上没有数据流动了，即不会再收到数据了，但是在这个TCP连接上仍然能够发送数据，直到这一方向也发送了FIN。首先进行关闭的一方将执行主动关闭，而另一方则执行被动关闭</p>
<p><strong>握手过程</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/TCP%E5%9B%9B%E6%AC%A1%E6%8F%A1%E6%89%8B.png" alt="四次"></p>
<ol>
<li><p><strong>第一阶段：</strong>Client发送一个FIN，用来关闭Client到Server的数据传送，Client进入FIN_WAIT_1状态</p>
</li>
<li><p><strong>第二阶段：</strong>Server收到FIN后，发送一个ACK给Client，确认序号为收到序号+1（与SYN相同，一个FIN占用一个序号），Server进入CLOSE_WAIT状态</p>
</li>
<li><p><strong>第三阶段：</strong>Server发送一个FIN，用来关闭Server到Client的数据传送，Server进入LAST_ACK状态</p>
</li>
<li><p><strong>第四阶段：</strong>Client收到FIN后，Client进入TIME_WAIT状态，接着发送一个ACK给Server，确认序号为收到序号+1，Server进入CLOSED状态，完成四次挥手</p>
</li>
</ol>
<h3 id="2-TCP数据包捕获"><a href="#2-TCP数据包捕获" class="headerlink" title="2. TCP数据包捕获"></a>2. TCP数据包捕获</h3><p><strong>(1) 使用捕获过滤器</strong></p>
<p><strong>网络环境</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/TCP%E6%8B%93%E6%89%91.png" alt=""></p>
<p><strong>捕获过程</strong></p>
<pre><code>1. 启动wireshark，选择Capture|Options，设置捕获条件，单击start开始捕获

2. 访问web服务器以产生TCP协议的数据包

3. 想要捕获TCP四次断开的数据包时，手动断开C-S连接，关闭web网页以捕获TCP四次断开的数据包
</code></pre><p><img src="http://paivdtahr.bkt.clouddn.com/fin-ack.png" alt=""></p>
<p>从该界面Info列中看到标志位<code>[FIN,ACK]</code>的包时，表示捕获到TCP四次断开的数据包</p>
<p><strong>(2) 显示过滤器及着色</strong></p>
<p><strong>三次握手过滤</strong></p>
<p>使用TCP协议中的标志位对数据包进行过滤，过滤<code>SYN=1</code>的数据包(三次握手)，显示过滤器输入<code>tcp.flags.syn==1</code>，Info列数据包描述为<code>SYN</code>和<code>[SYN，ACK]</code>包</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/syn.png" alt=""></p>
<p><strong>三次握手着色</strong></p>
<pre><code>1. 显示过滤器输入ip.addr==ip1 and ip.addr==ip2，将两台主机过滤

2. 选择数据帧单击右键，选择Colorize Conversation|TCP|Color，进行高亮着色

3. 可选择File|Export Specified Packets，指定范围到处捕获文件
</code></pre><p><strong>四次握手过滤</strong></p>
<p>若需要过滤<code>FIN=1</code>的数据包(四次断开)，使用<code>tcp.flags.fin==1</code>显示过滤器进行过滤，Info列数据包是<code>[FIN，ACK]</code>包</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/fin.png" alt=""></p>
<p><strong>四次握手显示及着色</strong></p>
<pre><code>1. 打开捕获文件，使用tcp.flags.fin==1过滤TCP四次断开的数据包

2. 显示过滤器输入ip.addr==ip1 and ip.addr==ip2，过滤特定主机间的数据包

3. 选择标志位为[FIN，ACK] 的数据包进行着色，可高亮显示TCP断开连接的整个会话

4. 选择特定数据帧，右键选择Mark Packet选项进行标记，再选择File|Export Specified Packets，在PAcket Range栏中选择Marked packet选项导出捕获文件
</code></pre><h3 id="3-TCP数据包分析"><a href="#3-TCP数据包分析" class="headerlink" title="3. TCP数据包分析"></a>3. TCP数据包分析</h3><p><strong>(1) TCP 首部</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/TCP%E5%A4%B4%E9%83%A8.png" alt="TCP头部"></p>
<pre><code>1. 源端口（Source Port）: 用于传输数据包的端口

2. 目的端口（Destination Port）: 数据包将要被发送到的端口

3. 序号（Sequence Number）: 用于表示一个TCP片段，这个域用来保证数据流中的部分没有缺失

4. 确认号（Acknowledgement Number）: 此数字是通信中希望从另一个设备得到的下一个数据包的序号

5. 保留：包括Reserved,Nonce,CWR和ECN-Echo,共6个比特位

6. 标记（Flag）: 用来表示所传输的TCP数据包的类型，包括URG,ACK,PSH,RST,SYN 和 FIN 6种

7. 窗口大小（Window Size）：TCP接收者缓冲的字节大小

8. 校验和（Checksum）: 用来保证TCP头和数据的内容在抵达目的地时的完整性

9. 选项（Options）: 各种可选的域，可在TCP数据包中进行指定

10. 紧急指针（Urgent Pointer）: 如果设置了URG位，这个域将被检查作为额外的指令，告诉CPU从数据包的哪里开始读取数据可以在TCP数据包中进行指定
</code></pre><p><strong>(2) TCP 标记</strong></p>
<pre><code>1. URG：紧急标志；此标志表示TCP的紧急指针域有效，保证TCP连接不被中断，并督促中间设备尽快处理这些数据

2. ACK：确认标志；此标志表示应答域有效，就是说前面所说的TCP应答号将会包含在TCP数据包中；有两个取值：0和1，为1的时候表示应答域有效，反之为0

3. PSH：这个标志位表示Push操作；所谓Push操作就是指在数据包到达接收端以后，立即传送给应用程序，而不是在缓冲区中排队

4. RST：这个标志表示连接复位请求；用来复位那些产生错误的连接，也被用来拒绝错误和非法的数据包

5. SYN：表示同步序号，用来建立连接。SYN标志位和ACK标志位搭配使用，当连接请求的时候，SYN=1，ACK=0；连接被相应的时 候，SYN=1，ACK= 1；这个标志的数据包经常被用来进行端口扫描。扫描者发送一个只有SYN的数据包，如果对方主机响应了一个数据包回来，就表明这台主机存在这个端口；但是 由于这种扫描方式只是进行TCP三次握手的第一次握手，因此这种扫描的成功表示被扫描的机器不很安全，一台安全的主机将会强制要求一个连接严格的进行 TCP的三次握手

6. FIN：表示发送端已经达到数据末尾，也就是说双方的数据传送完成，没有数据可以传送了，发送FIN标志位的TCP数据包后，连接将被断开。这个标志的数 据包也经常被用于进行端口扫描。当一个FIN标志的TCP数据包发送到一台计算机的特定端口，如果这台计算机响应了这个数据，并且反馈回来一个RST标志 的TCP包，就表明这台计算机上没有打开这个端口，但是这台计算机是存在的；如果这台计算机没有反馈回来任何数据包，这就表明，这台被扫描的计算机存在这个端口
</code></pre><hr>
<h2 id="0x05-UDP协议"><a href="#0x05-UDP协议" class="headerlink" title="0x05 UDP协议"></a>0x05 UDP协议</h2><h3 id="1-UDP协议概述"><a href="#1-UDP协议概述" class="headerlink" title="1. UDP协议概述"></a>1. UDP协议概述</h3><p>用户数据报协议（User Datagram Protocol,UDP）是一个简单的<strong>面向数据报</strong>的运输层协议，是一种尽力服务。UDP协议是<strong>无连接协议</strong>，不会正式地建立和结束主机之间的连接，也不存在握手和终止过程。UDP提供<strong>不可靠服务</strong>，主要是为了提供高速的传输，所以依赖于UDP的协议通常都会有其内置的可靠性服务，或者使用ICMP的一些功能来保证连接更可靠</p>
<h3 id="2-UDP数据包捕获"><a href="#2-UDP数据包捕获" class="headerlink" title="2. UDP数据包捕获"></a>2. UDP数据包捕获</h3><p><strong>(1) 网络环境</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/UDPhuanjing.png" alt=""></p>
<p><strong>(2) 捕获步骤</strong></p>
<pre><code>1. 启动wireshark，设置捕获过滤条件，单击Start开始捕获

2. 手动运行UDP协议程序(如QQ程序使用QICQ协议)，捕获UDP数据包
</code></pre><p><img src="http://paivdtahr.bkt.clouddn.com/QICQ.png" alt=""></p>
<h3 id="3-UDP数据包分析"><a href="#3-UDP数据包分析" class="headerlink" title="3. UDP数据包分析"></a>3. UDP数据包分析</h3><p><strong>(1) UDP首部格式</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/UDP.png" alt="UDP"></p>
<pre><code>源端口：用来传输数据包的端口

目标端口：数据包将要被传输到的端口

数据包长度：数据包的字节长度

校验和：用来确保UDP头和数据到达时的完整性

数据：被UDP封装进去的数据，包括应用层协议头部和用户发出去的数据
</code></pre><p><strong>(2) 分析UDP数据包</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/UDP%E6%95%B0%E6%8D%AE%E5%8C%85.png" alt=""></p>
<hr>
<h2 id="0x06-DHCP协议"><a href="#0x06-DHCP协议" class="headerlink" title="0x06 DHCP协议"></a>0x06 DHCP协议</h2><h3 id="1-DHCP协议简述"><a href="#1-DHCP协议简述" class="headerlink" title="1. DHCP协议简述"></a>1. DHCP协议简述</h3><p><strong>(1) DHCP 简述</strong></p>
<p>动态主机配置协议DHCP（Dynamic Host Configuration Protocol）是一个局域网的网络协议，能够让设备<strong>自动获取IP地址</strong>，它使用UDP协议工作。DHCP有3个端口，其中UDP67和UDP68为正常的服务器端口，费别作为DHCP Server和DHCP Client的服务器端口；546号端口用于DHCPv6 Client，为DHCP failover服务</p>
<p><strong>(2) DHCP作用</strong></p>
<p>DHCP基于Client/Server模式，为互联网上主机提供地址和配置参数</p>
<pre><code>1. 保证任何IP地址在同一时刻只能由一台DHCP客户机使用

2. DHCP可以给用户分配永久固定的IP地址

3. DHCP允许用其他方法获得IP地址的主机共存，如手动配置IP地址的主机

4. DHCP服务器向现有的BOOTP客户端提供服务
</code></pre><p><strong>(3) DHCP分配IP地址方式</strong></p>
<pre><code>1. 自动分配(Automatic Allocation)：DHCP给客户端分配永久性的IP地址

2. 动态分配(Dynamic Allocation)：DHCP给客户端分配的IP地址过一段时间会过期，客户端可主动释放该地址

3. 手动配置(Manual Allocation)：由用户手动为客户端指定IP地址
</code></pre><h3 id="DHCP头结构"><a href="#DHCP头结构" class="headerlink" title="DHCP头结构"></a>DHCP头结构</h3><p><img src="http://paivdtahr.bkt.clouddn.com/DHCP%E6%8A%A5%E6%96%87.png" alt="DHCP"></p>
<pre><code>操作代码（OpCode）：用来指出这个数据包时DHCP请求还是DHCP回复

硬件类型（Hardware Type）：硬件地址类型（10MB以太网，IEEE802，ATM以及其他）

跳数（Hops）：中继代理用来帮助寻找DHCP服务器

事物ID（Transaction ID）：用来匹配请求和响应的一个随机数

消耗时间（Seconds Elasped）：客户端第一次向DHCP服务器发出地址请求后时间

标记（Flags）：DHCP能够接受的流量类型（单播，广播及其他）

客户端IP地址（Client IP Address）：客户端的IP地址（由“你的”IP地址域派生）

&quot;你的&quot;IP地址（Your IP Address）：DHCP服务器提供的地址（最终成为客户端IP地址域的值）

服务器IP地址（Server IP Address）：DHCP服务器的IP地址

网关IP地址（Gateway IP Address）：网络默认网关的IP地址

客户端硬件地址（Client Hardware Address）：客户端的MAC地址

服务器主机名（Server Host Name）：服务器主机名（可选）

启动文件（Boot File）：DHCP所使用的启动文件（可选）

选项（Options）：用来对DHCP数据包进行扩展，一提供更多功能
</code></pre><p><strong>(4) DHCP工作流程</strong></p>
<p><img src="http://paivdtahr.bkt.clouddn.com/DHCP%E6%B5%81%E7%A8%8B.png" alt=""></p>
<p>DHCP最主要的任务就是在续租过程中向客户端分配IP地址，续租过程在一个客户端与DHCP服务器之间进行。DHCP的续租过程通常被成为DORA过程，它使用了4种类型的DHCP数据包：发现（Dicover），提供（Offer），请求（Request）和确认（Acknowledgement）</p>
<ol>
<li><strong>发现阶段</strong></li>
</ol>
<p>DHCP客户机寻找DHCP服务器的阶段。DHCP客户机以广播方式（因为DHCP服务器的IP地址对于客户机来说是未知的）发送DHCP discover发现信息来寻找DHCP服务器，即向地址255.255.255.255发送特定的广播信息。网络上每一台安装了TCP/IP协议的主机都会接收到这种广播信息，但只有DHCP服务器才会做出响应</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E5%8F%91%E7%8E%B0.png" alt="discover"></p>
<ol start="2">
<li><strong>提供阶段</strong></li>
</ol>
<p>DHCP服务器提供IP地址的阶段。在网络中接收到DHCP discover发现信息的DHCP服务器都会做出响应，它从尚未出租的IP地址中挑选一个分配给DHCP客户机，向DHCP客户机发送一个包含出租的IP地址和其他设置的DHCP offer提供信息</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E6%8F%90%E4%BE%9B.png" alt="提供"></p>
<ol start="3">
<li><strong>请求阶段</strong></li>
</ol>
<p>DHCP客户机选择某台DHCP服务器提供的IP地址的阶段。如果有多台DHCP服务器向DHCP客户机发来的DHCP offer提供信息，则DHCP客户机只接受第一个收到的DHCP offer提供信息，然后它就以广播方式回答一个DHCP request请求信息，该信息中包含向它所选定的DHCP服务器请求IP地址的内容。之所以要以广播方式回答，是为了通知所有的DHCP服务器，他将选择某台DHCP服务器所提供的IP地址</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E8%AF%B7%E6%B1%82.png" alt="请求"></p>
<ol start="4">
<li><strong>确认阶段</strong></li>
</ol>
<p>DHCP服务器确认所提供的IP地址的阶段。当DHCP服务器收到DHCP客户机回答的DHCP request请求信息之后，它便向DHCP客户机发送一个包含它所提供的IP地址和其他设置的DHCP ack确认信息，告诉DHCP客户机可以使用它所提供的IP地址。然后DHCP客户机便将其TCP/IP协议与网卡绑定，另外，除DHCP客户机选中的服务器外，其他的DHCP服务器都将收回曾提供的IP地址</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E7%A1%AE%E8%AE%A4.png" alt="ack"></p>
<p><strong>(5) 选项和消息类型</strong></p>
<p>DHCP依赖于其可选项来提供真正的灵活性，数据包的DHCP选项在大小和内容上都可以变化，数据包的整体大小则取决于其所使用的选项；所以DHCP数据包都需要唯一选项就是消息类型选项（选项53），这个选项标识着DHCP客户端或者服务器将如何处理数据包中的信息</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B.png" alt="消息"></p>
<hr>
<h2 id="0x07-DNS分析"><a href="#0x07-DNS分析" class="headerlink" title="0x07 DNS分析"></a>0x07 DNS分析</h2><h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>域名系统（DNS）是一种用于TCP/IP应用程序的分布式数据库，它提供主机名字和IP地址之间的转换及有关电子邮件的选路信息，DNS服务器存储了一个有着IP地址和DNS名字映射资源记录的数据库，并将其和客户端与其它DNS服务器共享</p>
<h3 id="DNS报文格式"><a href="#DNS报文格式" class="headerlink" title="DNS报文格式"></a>DNS报文格式</h3><p><img src="http://paivdtahr.bkt.clouddn.com/DNS.png" alt="DNS"></p>
<pre><code>DNS ID号（DNS ID Number）：用来对应DNS查询和DNS响应

查询/响应（Query/Response）：用于知名报文是DNS查询还是响应

操作代码（OpCode）：用于定义消息中请求的类型

权威应答（Authoritative Answer，AA）：若设定此值，则说明此响应是由域内权威域名服务器发出的

截断（Truncation，TC）：用于说明由于此响应太长，无法装入数据包而被截断

期望递归（Recursion Desired，RD）：当请求中设定此值，则说明DNS客户端在目标域名服务器不含有请求消息的情况下，要求进行递归查询

可用递归（Recurision Availiable，RA）：当响应中设定此值，说明域名服务器支持递归查询

保留（Z）：全设为0，有时会用作RCode域的扩展

响应代码（Response Code）：在DNS响应中用来指明错误

问题计数（Question Count）：在问题区段中的条目数

回答计数（Answer Count）：在回答区段中的条目数

域名服务器计数（Name Server Count）：在权威区段的域名资源记录数

额外记录计数（Additional Records Count）：在额外信息区段中其他资源记录数

问题区段（Question section）：大小可变，包含有被发送带DNS服务器的一条或多条的信息查询的部分

回答区段（Answer section）：大小可变，含有用来回答查询的额一条或多条资源记录

权威区段（Authority section）：大小可变，包含指向权威域名服务器的资源记录，用以继续解析过程

额外信息区段（Additional Information section）：包含资源记录且大小可变的区段，这些资源记录用来存储完全没有必要回答的查询相关的额外信息
</code></pre><h3 id="简单DNS查询"><a href="#简单DNS查询" class="headerlink" title="简单DNS查询"></a>简单DNS查询</h3><p>DNS以查询/响应的模式工作，当一个客户端轩昂要讲一个DNS名字解析成IP地址，它向DNS服务器发送一个查询，然后服务器会在响应中提供所请求的信息，最简单情况下，这个过程包含两个数据包</p>
<h3 id="DNS记录类型"><a href="#DNS记录类型" class="headerlink" title="DNS记录类型"></a>DNS记录类型</h3><p>DNS查询和响应中所使用的类型域，指明了这个查询或者响应的资源记录类型</p>
<p><img src="http://paivdtahr.bkt.clouddn.com/DNS%E7%B1%BB%E5%9E%8B.png" alt="DNS"></p>
<h3 id="DNS递归分析"><a href="#DNS递归分析" class="headerlink" title="DNS递归分析"></a>DNS递归分析</h3><p><img src="http://paivdtahr.bkt.clouddn.com/DNS%E9%80%92%E5%BD%92.png" alt="递归"></p>
<hr>
<h2 id="0xFF-参考资源"><a href="#0xFF-参考资源" class="headerlink" title="0xFF 参考资源"></a>0xFF 参考资源</h2><ul>
<li><p><a href="https://wiki.wireshark.org/" title="Wireshark Wiki" target="_blank" rel="noopener">Wireshark Wiki</a></p>
</li>
<li><p><a href="https://www.wireshark.org/docs/wsug_html_chunked/" title="Wireshark User’s Guide" target="_blank" rel="noopener">Wireshark User’s Guide</a></p>
</li>
</ul>
<ul>
<li><a href="https://pan.baidu.com/s/1xxXjp8P2giFAYtXjt8uqMA" title="《数据通信与网络 第六版》" target="_blank" rel="noopener">《数据通信与网络 第六版》</a></li>
</ul>
<ul>
<li><p><a href="https://pan.baidu.com/s/14-BMh0w6kF2QnAh_m7aIvg" title="《TCP/IP详解 卷一：协议》" target="_blank" rel="noopener">《TCP/IP详解 卷一：协议》</a></p>
</li>
<li><p><a href="https://pan.baidu.com/s/1MOLX3DfDgbaThxcEqFZPfg" title="Wireshark数据包分析实战" target="_blank" rel="noopener">《Wireshark数据包分析实战》</a></p>
</li>
</ul>
<ul>
<li><a href="https://pan.baidu.com/s/1pg7LUs4ndyXOWudnzWiscw" target="_blank" rel="noopener">《Wireshark数据包分析实战详解》</a></li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Wireshark/" rel="tag"><i class="fa fa-tag"></i> Wireshark</a>
          
            <a href="/tags/TCP-IP/" rel="tag"><i class="fa fa-tag"></i> TCP/IP</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/10/扫描-Nmap/" rel="next" title="Nmap 参考指南">
                <i class="fa fa-chevron-left"></i> Nmap 参考指南
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/07/24/SSL-TLS协议详解/" rel="prev" title="SSL/TLS协议详解">
                SSL/TLS协议详解 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Firehacker</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">24</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Hackerfire" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:firehafcker@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://firehacker.top/SecBook" target="_blank" title="Gitbook">
                      
                        <i class="fa fa-fw fa-book"></i>Gitbook</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-ARP协议"><span class="nav-number">1.</span> <span class="nav-text">0x01 ARP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-协议基础及原理"><span class="nav-number">1.1.</span> <span class="nav-text">1. 协议基础及原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-ARP协议包捕获及分析"><span class="nav-number">1.2.</span> <span class="nav-text">2. ARP协议包捕获及分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-IP协议"><span class="nav-number">2.</span> <span class="nav-text">0x02 IP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-协议原理及基础"><span class="nav-number">2.1.</span> <span class="nav-text">1. 协议原理及基础</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-IP数据报捕获及分析"><span class="nav-number">2.2.</span> <span class="nav-text">2. IP数据报捕获及分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-ICMP协议"><span class="nav-number">3.</span> <span class="nav-text">0x03 ICMP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-协议原理及基础-1"><span class="nav-number">3.1.</span> <span class="nav-text">1. 协议原理及基础</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-ICMP协议包捕获"><span class="nav-number">3.2.</span> <span class="nav-text">2. ICMP协议包捕获</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-ICMP报文类型"><span class="nav-number">3.3.</span> <span class="nav-text">3. ICMP报文类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-ICMP数据包分析"><span class="nav-number">3.4.</span> <span class="nav-text">4. ICMP数据包分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-TCP协议"><span class="nav-number">4.</span> <span class="nav-text">0x04 TCP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-协议基础及简述"><span class="nav-number">4.1.</span> <span class="nav-text">1. 协议基础及简述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-TCP数据包捕获"><span class="nav-number">4.2.</span> <span class="nav-text">2. TCP数据包捕获</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-TCP数据包分析"><span class="nav-number">4.3.</span> <span class="nav-text">3. TCP数据包分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-UDP协议"><span class="nav-number">5.</span> <span class="nav-text">0x05 UDP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-UDP协议概述"><span class="nav-number">5.1.</span> <span class="nav-text">1. UDP协议概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-UDP数据包捕获"><span class="nav-number">5.2.</span> <span class="nav-text">2. UDP数据包捕获</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-UDP数据包分析"><span class="nav-number">5.3.</span> <span class="nav-text">3. UDP数据包分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-DHCP协议"><span class="nav-number">6.</span> <span class="nav-text">0x06 DHCP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-DHCP协议简述"><span class="nav-number">6.1.</span> <span class="nav-text">1. DHCP协议简述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DHCP头结构"><span class="nav-number">6.2.</span> <span class="nav-text">DHCP头结构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-DNS分析"><span class="nav-number">7.</span> <span class="nav-text">0x07 DNS分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简述"><span class="nav-number">7.1.</span> <span class="nav-text">简述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS报文格式"><span class="nav-number">7.2.</span> <span class="nav-text">DNS报文格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#简单DNS查询"><span class="nav-number">7.3.</span> <span class="nav-text">简单DNS查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS记录类型"><span class="nav-number">7.4.</span> <span class="nav-text">DNS记录类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS递归分析"><span class="nav-number">7.5.</span> <span class="nav-text">DNS递归分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0xFF-参考资源"><span class="nav-number">8.</span> <span class="nav-text">0xFF 参考资源</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Firehacker</span>

  
</div>


<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

  <!-- <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>
-->





        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'cQ1pKGTukU9T7wK7hVqrFIy0-gzGzoHsz',
        appKey: '6l4mVkOTGKucdJoVS2dNCr0R',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

</body>
</html>
